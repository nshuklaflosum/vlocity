const a40_0x138cb7=a40_0x357e;(function(_0x1353a0,_0x4bebc1){const _0x12b017=a40_0x357e,_0x1e3b3a=_0x1353a0();while(!![]){try{const _0x278b73=-parseInt(_0x12b017(0x1ec))/0x1+parseInt(_0x12b017(0x1db))/0x2+parseInt(_0x12b017(0x244))/0x3*(-parseInt(_0x12b017(0x1a2))/0x4)+-parseInt(_0x12b017(0x214))/0x5*(-parseInt(_0x12b017(0x209))/0x6)+-parseInt(_0x12b017(0x20e))/0x7+-parseInt(_0x12b017(0x20b))/0x8+-parseInt(_0x12b017(0x23d))/0x9*(-parseInt(_0x12b017(0x245))/0xa);if(_0x278b73===_0x4bebc1)break;else _0x1e3b3a['push'](_0x1e3b3a['shift']());}catch(_0x19ceb5){_0x1e3b3a['push'](_0x1e3b3a['shift']());}}}(a40_0x2924,0x6da23));const fs2=require('fs/promises'),fs=require('fs'),crc32=require(a40_0x138cb7(0x200)),AdmZip=require(a40_0x138cb7(0x1d5)),yaml=require(a40_0x138cb7(0x1aa)),{resolve}=require(a40_0x138cb7(0x1a7)),path=require(a40_0x138cb7(0x1a7)),constants=require('../../../constants'),childProcess=require(a40_0x138cb7(0x237)),http=require(a40_0x138cb7(0x238)),{AvailableToExportCommand}=require(a40_0x138cb7(0x199)),{JsForceHelper}=require('../../../services/js-force'),{pathConfig}=require(a40_0x138cb7(0x246));function a40_0x357e(_0x440c0f,_0xa956f7){const _0x2924da=a40_0x2924();return a40_0x357e=function(_0x357eab,_0xdb4d34){_0x357eab=_0x357eab-0x199;let _0x1fd9cb=_0x2924da[_0x357eab];return _0x1fd9cb;},a40_0x357e(_0x440c0f,_0xa956f7);}class RetrieveHelper{constructor(_0x20beaf,_0x1a3e57,_0x1525ec){const _0x142b7b=a40_0x138cb7;this[_0x142b7b(0x1fa)]=_0x1a3e57[_0x142b7b(0x20d)][_0x142b7b(0x20f)],this[_0x142b7b(0x1d2)]=_0x1a3e57[_0x142b7b(0x20d)][_0x142b7b(0x1e3)],this[_0x142b7b(0x1a9)]=_0x1a3e57['logId'],this[_0x142b7b(0x216)]=_0x1a3e57[_0x142b7b(0x216)],this['projectPath']=_0x20beaf,this['flosumAuth']=_0x1a3e57[_0x142b7b(0x241)],this['nameSpacePrefix']=_0x1a3e57[_0x142b7b(0x1af)],this[_0x142b7b(0x23c)]=_0x1a3e57[_0x142b7b(0x23c)],this[_0x142b7b(0x1b0)]=_0x1a3e57['nameOfComponents'],this[_0x142b7b(0x1f2)]=_0x1a3e57[_0x142b7b(0x1f2)],this[_0x142b7b(0x1cf)]=_0x1a3e57[_0x142b7b(0x1cf)],this[_0x142b7b(0x1c7)]=_0x1a3e57[_0x142b7b(0x1c7)],this[_0x142b7b(0x228)]=JSON[_0x142b7b(0x1f9)](_0x1a3e57[_0x142b7b(0x228)]),this[_0x142b7b(0x1dd)]=_0x1a3e57[_0x142b7b(0x1dd)],this[_0x142b7b(0x1e1)]=_0x1a3e57[_0x142b7b(0x1e1)],this['isSeparateCalculationProcedureVersions']=_0x1a3e57[_0x142b7b(0x206)],this['isAfterUpdateSearchByKey']=_0x1a3e57['isAfterUpdateSearchByKey'],this[_0x142b7b(0x1e2)]=!!_0x1a3e57['isRunPackRetryAutomatically'],this['type']=_0x1a3e57[_0x142b7b(0x1ce)],this[_0x142b7b(0x1ff)]=_0x1a3e57[_0x142b7b(0x1ff)],this[_0x142b7b(0x221)]=_0x1525ec,this[_0x142b7b(0x1d8)]=new JsForceHelper(this[_0x142b7b(0x1ac)],_0x1525ec);}async['createYamlByDataPackTypes'](){const _0x58942b=a40_0x138cb7,_0x5dacf2=await new AvailableToExportCommand({'vlocityAuth':{'instanceUrl':this['vlocityUrl'],'accessToken':this[_0x58942b(0x1d2)]},'logger':this['logger']})[_0x58942b(0x1bf)]();if(!_0x5dacf2?.['records']?.[_0x58942b(0x1c3)])throw new Error('Records\x20to\x20export\x20not\x20a\x20found');const _0x2d44f4=this['nameOfComponents'][_0x58942b(0x1a5)](';')[_0x58942b(0x235)](_0x3ed157=>_0x3ed157[_0x58942b(0x21e)]()),_0x3ecbf0=new Set(this[_0x58942b(0x228)]),_0x412429=[];for(const {VlocityDataPackType:_0x56390c,Name:_0x7e5ff5,VlocityDataPackDisplayLabel:_0x5ba26b,VlocityDataPackKey:_0x1260a0}of _0x5dacf2[_0x58942b(0x22c)]){if(!_0x3ecbf0[_0x58942b(0x1fb)](_0x56390c))continue;const _0x18a1dd=_0x7e5ff5?.[_0x58942b(0x21e)]()||'',_0x21a1f7=_0x5ba26b?.[_0x58942b(0x21e)]()||'',_0x4fcde0=_0x1260a0?.['toLowerCase']()||'';(_0x2d44f4[_0x58942b(0x231)](_0x12d7f1=>_0x18a1dd['includes'](_0x12d7f1))||_0x2d44f4[_0x58942b(0x231)](_0x110aa0=>_0x21a1f7[_0x58942b(0x1ef)](_0x110aa0))||_0x2d44f4['some'](_0x128f50=>_0x4fcde0[_0x58942b(0x1ef)](_0x128f50)))&&_0x412429[_0x58942b(0x236)]('\x27'+_0x1260a0[_0x58942b(0x21c)]('\x27',_0x58942b(0x1b5))+'\x27');}const _0x46ef22='projectPath:\x20./'+constants[_0x58942b(0x1c5)]+_0x58942b(0x1e6)+_0x412429[_0x58942b(0x22e)](_0x58942b(0x1bd));fs[_0x58942b(0x212)](this['projectPath']+'/'+constants[_0x58942b(0x21f)],_0x46ef22),this[_0x58942b(0x221)][_0x58942b(0x1cd)](_0x58942b(0x223));}[a40_0x138cb7(0x22b)](){return new Promise((_0x11f34a,_0x1ef6d1)=>{const _0x2cbea5=a40_0x357e;try{this[_0x2cbea5(0x221)][_0x2cbea5(0x1cd)](_0x2cbea5(0x1f4));let _0x5da418;if(this[_0x2cbea5(0x1ce)]===_0x2cbea5(0x1f1)&&this[_0x2cbea5(0x1ff)]?.[_0x2cbea5(0x1c3)]){const _0x1e9404=this[_0x2cbea5(0x1ff)]['map'](_0x5b4301=>'\x27'+_0x5b4301[_0x2cbea5(0x21c)]('\x27',_0x2cbea5(0x1b5))+'\x27');_0x5da418=_0x2cbea5(0x1eb)+constants['UNZIP_CATALOG_NAME']+'\x0amanifest:\x0a\x20-\x20'+_0x1e9404[_0x2cbea5(0x22e)](_0x2cbea5(0x1bd)),fs['appendFileSync'](this['projectPath']+'/'+constants[_0x2cbea5(0x21f)],_0x5da418),this['logger'][_0x2cbea5(0x1cd)](_0x2cbea5(0x223)),_0x11f34a();return;}if(this[_0x2cbea5(0x1ce)]===_0x2cbea5(0x1c6)){this['createYamlByDataPackTypes']()[_0x2cbea5(0x1ab)](()=>_0x11f34a())['catch'](_0x9582f3=>{const _0x2438fb=_0x2cbea5;this[_0x2438fb(0x221)][_0x2438fb(0x1cd)]('Error\x20Create\x20Job\x20File'),_0x1ef6d1(_0x9582f3);});return;}_0x5da418='projectPath:\x20./'+constants['UNZIP_CATALOG_NAME']+'\x0a';if(this['isAfterUpdateSearchByKey']){if(this['nameOfComponents']){if(this[_0x2cbea5(0x1f2)]===_0x2cbea5(0x1fc)){const _0x4c3f93=this['nameOfComponents']['split']('\x0a')['filter'](_0x29c7ad=>_0x29c7ad['trim']()[_0x2cbea5(0x222)]('-'))[_0x2cbea5(0x235)](_0x4b3e34=>_0x4b3e34[_0x2cbea5(0x1e5)]('-','')[_0x2cbea5(0x20a)]());_0x4c3f93[_0x2cbea5(0x1c3)]?(_0x5da418+=_0x2cbea5(0x1c8),_0x5da418+=_0x4c3f93['join']('\x0a\x20-\x20'),fs[_0x2cbea5(0x212)](this['projectPath']+'/'+constants['JOB_FILE_NAME'],_0x5da418),this['logger'][_0x2cbea5(0x1cd)](_0x2cbea5(0x223)),_0x11f34a()):_0x1ef6d1(_0x2cbea5(0x1ca));}if(this[_0x2cbea5(0x1f2)]==='yaml')try{const _0x272cdb=yaml[_0x2cbea5(0x22a)](this[_0x2cbea5(0x1b0)]);_0x272cdb[_0x2cbea5(0x19e)]=_0x2cbea5(0x1f5),fs['appendFileSync'](this[_0x2cbea5(0x19e)]+'/'+constants[_0x2cbea5(0x21f)],yaml[_0x2cbea5(0x230)](_0x272cdb)),_0x11f34a(),this[_0x2cbea5(0x221)]['log'](_0x2cbea5(0x223));}catch(_0x2fac9c){this[_0x2cbea5(0x221)]['log'](_0x2cbea5(0x219)+_0x2fac9c),_0x1ef6d1(_0x2fac9c);}else _0x5da418+=_0x2cbea5(0x243)+this[_0x2cbea5(0x1c4)](),fs[_0x2cbea5(0x212)](this[_0x2cbea5(0x19e)]+'/'+constants[_0x2cbea5(0x21f)],_0x5da418),_0x11f34a(),this[_0x2cbea5(0x221)][_0x2cbea5(0x1cd)]('End\x20Create\x20Job\x20File');}else _0x5da418+='queries:\x0a'+this[_0x2cbea5(0x1c4)](),fs[_0x2cbea5(0x212)](this['projectPath']+'/'+constants['JOB_FILE_NAME'],_0x5da418),_0x11f34a(),this['logger'][_0x2cbea5(0x1cd)](_0x2cbea5(0x223));}else _0x5da418+=_0x2cbea5(0x243)+this[_0x2cbea5(0x1c4)](),fs[_0x2cbea5(0x212)](this[_0x2cbea5(0x19e)]+'/'+constants[_0x2cbea5(0x21f)],_0x5da418),_0x11f34a(),this[_0x2cbea5(0x221)][_0x2cbea5(0x1cd)](_0x2cbea5(0x223));}catch(_0x3e41a1){this[_0x2cbea5(0x221)][_0x2cbea5(0x1cd)](_0x2cbea5(0x1de)+_0x3e41a1),_0x1ef6d1(_0x3e41a1);}});}[a40_0x138cb7(0x1c4)](){const _0x2c3abd=a40_0x138cb7,_0x43acc6=Array[_0x2c3abd(0x1e4)](this[_0x2c3abd(0x228)])?this[_0x2c3abd(0x228)]:Object[_0x2c3abd(0x1ff)](this[_0x2c3abd(0x228)]),_0x583576=[];/^ *$/['test'](this[_0x2c3abd(0x1b0)])?this[_0x2c3abd(0x1b0)]=[]:this[_0x2c3abd(0x1b0)]=this['nameOfComponents'][_0x2c3abd(0x1a5)](';');if(this['nameOfComponents'][_0x2c3abd(0x1c3)]){const _0x22d833=this[_0x2c3abd(0x1cf)]?this[_0x2c3abd(0x1b0)][_0x2c3abd(0x22e)](_0x2c3abd(0x227)):this[_0x2c3abd(0x1b0)][_0x2c3abd(0x22e)](_0x2c3abd(0x1fe));for(const _0x27ec17 of _0x43acc6){_0x583576[_0x2c3abd(0x236)](this[_0x2c3abd(0x233)](_0x27ec17,_0x22d833));}}else for(const _0x4389bc of _0x43acc6){const _0x4fcdaa=constants[_0x2c3abd(0x232)][_0x2c3abd(0x1ef)](_0x4389bc)?this[_0x2c3abd(0x233)](_0x4389bc):'-\x20'+_0x4389bc;_0x583576[_0x2c3abd(0x236)](_0x4fcdaa);}return _0x583576[_0x2c3abd(0x22e)]('\x0a');}['createQuery'](_0x9f525d,_0x5e0d00=null){const _0xc85948=a40_0x138cb7,_0xed6ea3=constants[_0xc85948(0x1dc)][_0x9f525d];let _0x3cc6ec='';if(_0xed6ea3){const _0xdd16ea=_0xed6ea3[_0xc85948(0x205)][_0xc85948(0x1d0)](_0xc85948(0x1ea))&&!!this['vlocityNameSpacePrefix']?''+this[_0xc85948(0x23c)]+_0xed6ea3[_0xc85948(0x205)]:''+_0xed6ea3['objectName'];_0x3cc6ec=_0xc85948(0x1cc)+_0x9f525d+'\x0a';const _0x586494=_0xed6ea3[_0xc85948(0x1ae)]['replace'](new RegExp(constants['VLOCITY_NAMESPACE_PREFIX_CODE'],'g'),this[_0xc85948(0x23c)]);this[_0xc85948(0x1cf)]?(_0x3cc6ec+='\x20\x20query:\x20SELECT\x20'+_0x586494+_0xc85948(0x19b)+_0xdd16ea,_0x5e0d00&&(_0x3cc6ec+='\x20WHERE\x20(Name\x20LIKE\x20\x27%'+_0x5e0d00+_0xc85948(0x1b7))):(_0x3cc6ec+=_0xc85948(0x1d4)+_0x586494+'\x20FROM\x20'+_0xdd16ea,_0x5e0d00&&(_0x3cc6ec+='\x20WHERE\x20Name\x20IN\x20(\x27'+_0x5e0d00+'\x27)'));if(_0xed6ea3['query']){const _0x1b265c=_0x5e0d00?_0xc85948(0x1ba):_0xc85948(0x229),_0x437644=_0xed6ea3[_0xc85948(0x1a0)][_0xc85948(0x1e5)](new RegExp(constants[_0xc85948(0x213)],'g'),this[_0xc85948(0x23c)]);_0x3cc6ec+='\x20'+_0x1b265c+'\x20'+_0x437644+'\x0a';}else _0x3cc6ec+='\x0a';}return _0x3cc6ec;}[a40_0x138cb7(0x1be)](){return new Promise((_0x17fd39,_0x45c142)=>{const _0x4f538c=a40_0x357e;try{this[_0x4f538c(0x221)][_0x4f538c(0x1cd)](_0x4f538c(0x1bc));const _0x18e7d3=_0x4f538c(0x23f),_0x3385b3=this[_0x4f538c(0x1dd)]?'0':'-1',_0x469645=[_0x4f538c(0x207),''+this[_0x4f538c(0x1d2)],_0x4f538c(0x226),''+this['vlocityUrl'],'-job',''+constants[_0x4f538c(0x21f)],'-autoRetryErrors','-maxDepth',_0x3385b3];this['isSeparateMatrixVersions']&&_0x469645[_0x4f538c(0x236)](_0x4f538c(0x1e8));this[_0x4f538c(0x206)]&&_0x469645[_0x4f538c(0x236)]('-separateCalculationProcedureVersions');_0x469645[_0x4f538c(0x236)](_0x4f538c(0x1c1));const _0xe2cd0=()=>{const _0x449a67=_0x4f538c;http['updateAttachmentLog'](this[_0x449a67(0x19e)],this[_0x449a67(0x1d8)],this[_0x449a67(0x216)],this[_0x449a67(0x221)],![]);};this[_0x4f538c(0x221)]['log'](_0x469645[_0x4f538c(0x22e)]('\x20'));const _0x441a2e={'cwd':''+this[_0x4f538c(0x19e)],'maxBuffer':0x400*0x1f4,'shell':!![]};childProcess['callChildProcess'](_0x18e7d3,_0x469645,this[_0x4f538c(0x221)],_0x441a2e,!![],_0xe2cd0)[_0x4f538c(0x1ab)](_0x2c3285=>{const _0x5172a4=_0x4f538c;this[_0x5172a4(0x221)]['log'](_0x5172a4(0x1df)),_0x17fd39(_0x2c3285);})['catch'](_0x54e80d=>{const _0x29f4f3=_0x4f538c;this[_0x29f4f3(0x221)][_0x29f4f3(0x1cd)](_0x29f4f3(0x21a)+_0x54e80d),_0x45c142(_0x54e80d);});}catch(_0x244b45){_0x45c142(_0x244b45);}});}[a40_0x138cb7(0x1d3)](){return new Promise((_0x5c2b46,_0x6b3f14)=>{const _0x2b5511=a40_0x357e;try{this[_0x2b5511(0x221)][_0x2b5511(0x1cd)](_0x2b5511(0x1c2));let _0xeffb8d=0x0,_0x20fa4e=[],_0x1bdd60=0x0;const _0x5f3103=[],_0x52d6e5=this[_0x2b5511(0x19e)]+'/'+constants[_0x2b5511(0x1c5)],_0x107c6d=fs[_0x2b5511(0x225)](_0x52d6e5);for(let _0x2b0980=0x0;_0x2b0980<_0x107c6d['length'];_0x2b0980++){const _0x513b1d=_0x107c6d[_0x2b0980]==='ContentVersion'?'Title':'Name',_0x17dd8d=_0x52d6e5+'/'+_0x107c6d[_0x2b0980],_0x56dff1=fs['readdirSync'](_0x17dd8d);for(let _0x148efa=0x0;_0x148efa<_0x56dff1[_0x2b5511(0x1c3)];_0x148efa++){const _0x68c8e7=_0x107c6d[_0x2b0980]+'/'+_0x56dff1[_0x148efa];let _0x36b27f=_0x56dff1[_0x148efa];const _0x592182=[],_0x10e0d5=_0x52d6e5+'/'+_0x107c6d[_0x2b0980]+'/'+_0x56dff1[_0x148efa],_0x1886fd=fs['readdirSync'](_0x10e0d5);_0x1886fd[_0x2b5511(0x22f)](_0x1fca8a=>{const _0x2aef93=_0x2b5511;try{_0x1fca8a[_0x2aef93(0x1b2)]()[_0x2aef93(0x1d0)]('_DataPack.json')&&(_0x36b27f=JSON[_0x2aef93(0x1f9)](fs['readFileSync'](_0x10e0d5+'/'+_0x1fca8a)[_0x2aef93(0x1b2)]())[_0x513b1d]);}catch(_0x395fc6){this['logger'][_0x2aef93(0x1cd)](_0x2aef93(0x1c9)+_0x1fca8a);}!_0x36b27f&&(_0x36b27f=undefined),fs[_0x2aef93(0x1d6)](_0x10e0d5+'/'+_0x1fca8a[_0x2aef93(0x1b2)]())[_0x2aef93(0x1a3)]()&&_0x592182['push'](...this[_0x2aef93(0x1d1)](_0x10e0d5,_0x1fca8a));});const _0x55bc51=new AdmZip();_0x55bc51[_0x2b5511(0x218)](_0x10e0d5,_0x107c6d[_0x2b0980]+'/'+_0x56dff1[_0x148efa]);const _0xa9142=_0x55bc51['toBuffer'](),_0x1d9096=crc32['buf'](_0xa9142),_0x664743=_0xa9142[_0x2b5511(0x1b2)](_0x2b5511(0x204)),_0x288f4f={'fileName':_0x36b27f,'name':_0x56dff1[_0x148efa],'type':_0x107c6d[_0x2b0980],'label':_0x68c8e7,'crc':_0x1d9096,'base64':_0x664743,'snapshotId':this['snapshotId'],'subItemList':JSON['stringify'](_0x592182)},_0x14808f=_0xa9142[_0x2b5511(0x1c3)]/0xf4240,_0x5c1e2b=!!(_0x56dff1[_0x2b5511(0x1c3)]-0x1===_0x148efa&&_0x107c6d[_0x2b5511(0x1c3)]-0x1===_0x2b0980);_0xeffb8d+=_0x14808f,_0xeffb8d>0x2||_0x20fa4e>0xfa0?(_0x5f3103[_0x2b5511(0x236)](_0x20fa4e),_0x14808f<0x3?(_0x20fa4e=[_0x288f4f],_0x1bdd60++,_0xeffb8d=_0x14808f):(this[_0x2b5511(0x221)][_0x2b5511(0x1cd)](_0x2b5511(0x19c)+_0x68c8e7+',\x20size\x20more\x20then\x203mb.',!![]),_0xeffb8d=0x0)):(_0x20fa4e[_0x2b5511(0x236)](_0x288f4f),_0x1bdd60++),_0x5c1e2b&&_0x5f3103[_0x2b5511(0x236)](_0x20fa4e);}}this[_0x2b5511(0x221)][_0x2b5511(0x1cd)](_0x2b5511(0x1c0)),_0x5c2b46({'iteratorDeploy':_0x5f3103[Symbol[_0x2b5511(0x1ed)]](),'count':_0x1bdd60});}catch(_0x3c3f92){this['logger']['log'](_0x2b5511(0x1b4)),_0x6b3f14(_0x3c3f92);}});}[a40_0x138cb7(0x1d1)](_0x1142ba,_0x5c745b,_0xccffd7='',_0x5c98cb=[]){const _0x124b57=a40_0x138cb7;_0xccffd7[_0x124b57(0x1c3)]&&(_0xccffd7='/'+_0xccffd7);const _0x6bdb5a=fs[_0x124b57(0x225)](_0x1142ba+'/'+_0x5c745b+_0xccffd7);return _0x6bdb5a[_0x124b57(0x22f)](_0x5030b8=>{const _0x244706=_0x124b57;!fs[_0x244706(0x1d6)](_0x1142ba+'/'+_0x5c745b+_0xccffd7+'/'+_0x5030b8['toString']())[_0x244706(0x1a3)]()?_0x5c98cb['push'](''+_0x5c745b+_0xccffd7+'/'+_0x5030b8[_0x244706(0x1b2)]()):this[_0x244706(0x1d1)](_0x1142ba,_0x5c745b,_0x5030b8,_0x5c98cb);}),_0x5c98cb;}[a40_0x138cb7(0x1e7)](_0x4c37a0,_0x19a5de='',_0x3d1989=[]){const _0x1f70d4=a40_0x138cb7,_0x289e88=fs[_0x1f70d4(0x225)](_0x4c37a0,{'withFileTypes':!![]});return _0x289e88[_0x1f70d4(0x22f)](_0x410dbd=>{const _0x5dae77=_0x1f70d4,_0x347137=resolve(_0x4c37a0,_0x410dbd[_0x5dae77(0x1b6)]);if(_0x410dbd['isDirectory']()){const _0x1e0d65=_0x19a5de[_0x5dae77(0x1c3)]?_0x19a5de+'/'+_0x410dbd[_0x5dae77(0x1b6)]:_0x410dbd[_0x5dae77(0x1b6)];this['readFiles'](_0x347137,_0x1e0d65,_0x3d1989);}else{let _0x316eb1;_0x19a5de['length']?_0x316eb1=_0x19a5de+'/'+_0x410dbd[_0x5dae77(0x1b6)]:_0x316eb1=_0x410dbd[_0x5dae77(0x1b6)],_0x3d1989['push'](_0x316eb1);}}),_0x3d1989;}[a40_0x138cb7(0x23b)](_0x110fbb){return new Promise((_0x546f71,_0x246c60)=>{const _0x45fdb3=a40_0x357e;try{this[_0x45fdb3(0x221)][_0x45fdb3(0x1cd)](_0x45fdb3(0x247)),this[_0x45fdb3(0x1d7)](_0x110fbb)[_0x45fdb3(0x1ab)](()=>{const _0x3587e9=_0x45fdb3;this[_0x3587e9(0x221)][_0x3587e9(0x1cd)](_0x3587e9(0x1bb)),_0x546f71();})[_0x45fdb3(0x22d)](_0x45129a=>{const _0xb6ccca=_0x45fdb3;this['logger']['log'](_0xb6ccca(0x1f3)+_0x45129a),_0x246c60(_0x45129a);});}catch(_0x5baac2){_0x246c60(_0x5baac2);}});}['nextChunk'](_0x4a6631,_0x4a80f0=0x0){return new Promise((_0x5726f7,_0x4f58e4)=>{const _0x554bb3=a40_0x357e;try{const _0x5c15e4=_0x4a6631[_0x554bb3(0x1cb)][_0x554bb3(0x20c)]();_0x5c15e4[_0x554bb3(0x217)]?_0x5726f7():this[_0x554bb3(0x202)](_0x4a6631,_0x5c15e4,_0x4a80f0)['then'](()=>_0x5726f7())[_0x554bb3(0x22d)](_0x206d01=>_0x4f58e4(_0x206d01));}catch(_0x2675a2){_0x4f58e4(_0x2675a2);}});}[a40_0x138cb7(0x202)](_0x28a833,_0x3b902b,_0x3b33f3=0x0){return new Promise((_0x51e696,_0x4797a6)=>{const _0x25a45c=a40_0x357e;try{const _0x463df1={'items':_0x3b902b['value']};http['post'](this['flosumAuth'],this[_0x25a45c(0x1af)],_0x463df1,_0x25a45c(0x1f8))[_0x25a45c(0x1ab)](()=>{const _0x13bdad=_0x25a45c;return _0x3b33f3+=_0x3b902b[_0x13bdad(0x1b8)][_0x13bdad(0x1c3)],this['logger'][_0x13bdad(0x1cd)](_0x13bdad(0x1f0)+_0x3b33f3+_0x13bdad(0x211)+_0x28a833[_0x13bdad(0x1f7)]),Promise[_0x13bdad(0x201)]();})[_0x25a45c(0x22d)](_0x4e2192=>{const _0x553c2b=_0x25a45c;return this['logger'][_0x553c2b(0x1cd)]('Error\x20deploy\x20chunk\x20'+_0x4e2192),Promise[_0x553c2b(0x201)]();})[_0x25a45c(0x1ab)](()=>this['nextChunk'](_0x28a833,_0x3b33f3))[_0x25a45c(0x1ab)](_0x51e696)[_0x25a45c(0x22d)](_0x4797a6);}catch(_0x3a239f){_0x4797a6(_0x3a239f);}});}['createVlocityTempZip'](){return new Promise(_0x5d21ed=>{const _0x598107=a40_0x357e;try{this['logger'][_0x598107(0x1cd)](_0x598107(0x1a1));const _0x128d18=this[_0x598107(0x19e)]+'/'+constants[_0x598107(0x1b1)];if(fs['existsSync'](_0x128d18)){const _0x24dbc7=_0x128d18+_0x598107(0x239);if(this[_0x598107(0x221)][_0x598107(0x1a4)][_0x598107(0x1c3)]&&fs['existsSync'](_0x24dbc7)){const _0xee05d=fs[_0x598107(0x225)](_0x24dbc7);if(_0xee05d&&_0xee05d['length']){const _0x2e9326=_0xee05d[0x0];if(_0x2e9326[_0x598107(0x1ef)](_0x598107(0x240))&&_0x2e9326[_0x598107(0x1ef)](_0x598107(0x208))){const _0x568534=_0x598107(0x203)+JSON[_0x598107(0x1d9)](this[_0x598107(0x221)][_0x598107(0x1a4)]);fs[_0x598107(0x212)]('./'+_0x24dbc7+'/'+_0x2e9326,_0x568534);}}}const _0x3ad460=new AdmZip();_0x3ad460[_0x598107(0x218)](_0x128d18,constants[_0x598107(0x1b1)]),_0x5d21ed(_0x3ad460[_0x598107(0x19f)]()[_0x598107(0x1b2)](_0x598107(0x204))),this[_0x598107(0x221)][_0x598107(0x1cd)](_0x598107(0x23e));}else this[_0x598107(0x221)]['log'](_0x598107(0x1e9)),_0x5d21ed();}catch(_0x49c91d){this['logger']['log'](_0x598107(0x21d)+_0x49c91d),_0x5d21ed();}});}async[a40_0x138cb7(0x210)](_0x2a8bcf){const _0x4121ec=a40_0x138cb7;this[_0x4121ec(0x221)][_0x4121ec(0x1cd)](_0x4121ec(0x1ad));const _0x11d734={'Name':'Vlocity\x20Temp','ContentType':_0x4121ec(0x1e0),'Description':_0x4121ec(0x21b),'ParentId':this[_0x4121ec(0x1c7)],'Body':_0x2a8bcf};await this[_0x4121ec(0x1d8)][_0x4121ec(0x19d)](_0x11d734),this[_0x4121ec(0x221)][_0x4121ec(0x1cd)](_0x4121ec(0x1b9));}[a40_0x138cb7(0x23a)](){return new Promise(_0x44ffa4=>{const _0x13dace=a40_0x357e;try{if(fs[_0x13dace(0x215)](this[_0x13dace(0x19e)]+'/'+constants['NAME_LOGS_FILE'])){const _0x2c0ece=yaml['load'](fs['readFileSync'](this[_0x13dace(0x19e)]+'/'+constants[_0x13dace(0x1f6)],_0x13dace(0x1a6)));_0x2c0ece['Errors']&&_0x2c0ece[_0x13dace(0x1a8)][_0x13dace(0x1c3)]?(this[_0x13dace(0x221)][_0x13dace(0x1cd)](_0x13dace(0x19a)+_0x2c0ece[_0x13dace(0x1a8)]['join']('\x0a')),_0x44ffa4(!![])):_0x44ffa4(![]);}else _0x44ffa4(![]);}catch(_0x56fc7b){_0x44ffa4(![]);}});}['completeDeployment'](_0x4adfcb,_0x22d94a=![]){return new Promise((_0x166978,_0x327b5b)=>{const _0x336c14=a40_0x357e;try{Promise[_0x336c14(0x201)]()[_0x336c14(0x1ab)](()=>this[_0x336c14(0x1ee)]())[_0x336c14(0x1ab)](_0x3d23da=>{const _0x47ffaa=_0x336c14;if(_0x3d23da)return this['sendVlocityTemp'](_0x3d23da);return Promise[_0x47ffaa(0x201)]();})['then'](()=>http[_0x336c14(0x242)](this[_0x336c14(0x19e)],this[_0x336c14(0x1d8)],this[_0x336c14(0x216)],this[_0x336c14(0x221)],_0x22d94a,!![]))[_0x336c14(0x1ab)](_0x55b458=>{const _0x2617be=_0x336c14;return _0x22d94a=_0x55b458,http[_0x2617be(0x1da)](this[_0x2617be(0x1d8)],this[_0x2617be(0x1a9)],this[_0x2617be(0x1af)],_0x4adfcb,this[_0x2617be(0x221)],_0x55b458);})[_0x336c14(0x1ab)](()=>this['callUpdateSnapshot'](_0x22d94a));}catch(_0x217f19){_0x327b5b(_0x217f19);}});}async[a40_0x138cb7(0x234)](_0x461734){const _0x39f426=a40_0x138cb7;this['logger'][_0x39f426(0x1cd)]('Start\x20Update\x20Snapshot');const _0x418402={'Id':this[_0x39f426(0x1c7)],[this[_0x39f426(0x1af)]+'Is_Completed__c']:!![],[this['nameSpacePrefix']+_0x39f426(0x1b3)]:_0x461734};return await this[_0x39f426(0x1d8)][_0x39f426(0x220)](this[_0x39f426(0x1af)],_0x418402),this['logger'][_0x39f426(0x1cd)](_0x39f426(0x1fd)),_0x418402[this[_0x39f426(0x1af)]+_0x39f426(0x1b3)];}}function a40_0x2924(){const _0x4420d2=['resolve','deploy','FlosumErrors:\x20','base64','objectName','isSeparateCalculationProcedureVersions','-sf.accessToken','-Export.yaml','5430mQDHzv','trim','1162216soPJTa','next','authVlosityOrg','5686366TemrkD','instanceUrl','sendVlocityTemp','\x20from\x20','appendFileSync','VLOCITY_NAMESPACE_PREFIX_CODE','4340zDagbT','existsSync','attachLogId','done','addLocalFolder','Error\x20Create\x20Job\x20File,\x20Not\x20Valid\x20Provided\x20Yaml\x20File:\x20','Error\x20Retrieve\x20Data\x20','Vlocity\x20Temp','replaceAll','Error\x20Create\x20Vlocity\x20Temp\x20Zip\x20','toLowerCase','JOB_FILE_NAME','updateSnapshot','logger','startsWith','End\x20Create\x20Job\x20File','exports','readdirSync','-sf.instanceUrl','%\x27\x20OR\x20Name\x20LIKE\x20\x27%','selectedDataPackTypes','WHERE','load','createJobYamlFile','records','catch','join','forEach','dump','some','UNSUPPORTED_BY_DEFAULT_LIST','createQuery','callUpdateSnapshot','map','push','../../../services/child-process','../../../services/http','/logs','checkErrors','deployComponents','vlocityNameSpacePrefix','1467xcoHEv','End\x20Create\x20Vlocity\x20Temp\x20Zip','vlocity','job-yaml-','authFlosum','updateAttachmentLog','queries:\x0a','13014rJlTZu','49700ZiMcjf','../../../config/path','Start\x20Deploy\x20Components','../../../services/cli-commands/available-to-export.command','Errors\x20found,\x20start\x20pack\x20retry\x20command\x20\x0a','\x20FROM\x20','Cannot\x20retrieve\x20component\x20','createAttachment','projectPath','toBuffer','query','Start\x20Create\x20Vlocity\x20Temp\x20Zip','80cXjKPi','isDirectory','errors','split','utf8','path','Errors','logId','js-yaml','then','flosumAuth','Start\x20Send\x20Vlocity\x20Temp','fields','nameSpacePrefix','nameOfComponents','VLOCITY_TEMP_CATALOG','toString','Is_Error__c','Error\x20Prepare\x20Data\x20For\x20Deploy','\x5c\x27\x27','name','%\x27)','value','End\x20Send\x20Vlocity\x20Temp','AND','End\x20Deploy\x20Components','Start\x20Retrieve\x20Data','\x0a\x20-\x20','retrieveData','execute','End\x20Prepare\x20Data\x20For\x20Deploy','packExport','Start\x20Prepare\x20Data\x20For\x20Deploy','length','getVlocityQueries','UNZIP_CATALOG_NAME','types','snapshotId','manifest:\x0a\x20-\x20','Error\x20parse\x20component\x20','Error,\x20Components\x20not\x20found','iteratorDeploy','-\x20VlocityDataPackType:\x20','log','type','isLikeSearch','endsWith','findSubItems','vlocityToken','prepareDataForDeploy','\x20\x20query:\x20SELECT\x20','adm-zip','lstatSync','nextChunk','jsForceHelper','stringify','callUpdateLog','779844vibdDQ','DATA_PACK_TYPES_QUERIES_MAP','isNotIncludeDependencies','Error\x20Create\x20Job\x20File\x20','End\x20Retrieve\x20Data','application/zip','isSeparateMatrixVersions','isRunPackRetryAutomatically','accessToken','isArray','replace','\x0amanifest:\x0a\x20-\x20','readFiles','-separateMatrixVersions','Error\x20Create\x20Vlocity\x20Temp\x20Zip,\x20Vlocity\x20Temp\x20not\x20found','__c','projectPath:\x20./','492138ktMBAd','iterator','createVlocityTempZip','includes','Deployed\x20','selective','searchBy','Error\x20Deploy\x20Components\x20','Start\x20Create\x20Job\x20File','./source_data','NAME_LOGS_FILE','count','SnapshotVlocity/','parse','vlocityUrl','has','key','End\x20Update\x20Snapshot','\x27,\x27','keys','crc-32'];a40_0x2924=function(){return _0x4420d2;};return a40_0x2924();}module[a40_0x138cb7(0x224)]={'RetrieveHelper':RetrieveHelper};