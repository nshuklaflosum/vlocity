const a34_0x370aac=a34_0x2c3a;(function(_0x583c37,_0x1587e1){const _0x40d28f=a34_0x2c3a,_0x19b23f=_0x583c37();while(!![]){try{const _0x3ddd86=-parseInt(_0x40d28f(0xe9))/0x1+parseInt(_0x40d28f(0xe6))/0x2+parseInt(_0x40d28f(0x121))/0x3*(parseInt(_0x40d28f(0x108))/0x4)+-parseInt(_0x40d28f(0xdb))/0x5+parseInt(_0x40d28f(0xeb))/0x6+-parseInt(_0x40d28f(0x11c))/0x7*(parseInt(_0x40d28f(0xf4))/0x8)+-parseInt(_0x40d28f(0xfb))/0x9*(-parseInt(_0x40d28f(0xec))/0xa);if(_0x3ddd86===_0x1587e1)break;else _0x19b23f['push'](_0x19b23f['shift']());}catch(_0x21dfea){_0x19b23f['push'](_0x19b23f['shift']());}}}(a34_0x18a5,0xeda0e));const path=require(a34_0x370aac(0x11e)),fs=require('fs'),fse=require(a34_0x370aac(0xf0)),AdmZip=require(a34_0x370aac(0xdc)),constants=require('../../../constants'),http=require(a34_0x370aac(0xf3));function query(_0x45e8de,_0x3938bd,_0x4386bb){return new Promise((_0x5e0119,_0x27dbc2)=>{const _0x25500d=a34_0x2c3a;try{_0x4386bb[_0x25500d(0xd8)]('Start\x20Query'),_0x45e8de['query'](_0x3938bd,(_0x349815,_0x3073b7)=>{const _0x1b93b1=_0x25500d;_0x349815?(_0x4386bb[_0x1b93b1(0xd8)]('Error\x20Query\x20'+_0x349815),_0x27dbc2(_0x349815)):(_0x4386bb[_0x1b93b1(0xd8)](_0x1b93b1(0x126)),_0x5e0119(_0x3073b7[_0x1b93b1(0xee)][_0x1b93b1(0x110)](_0x4eade5=>_0x4eade5[_0x1b93b1(0xd7)]&&_0x4eade5['vlocity_cmt__SubType__c']&&_0x4eade5['vlocity_cmt__Language__c'])['map'](({vlocity_cmt__Type__c:_0x224c00,vlocity_cmt__SubType__c:_0x1c4141,vlocity_cmt__Language__c:_0x4df43})=>''+_0x224c00+_0x1c4141+_0x4df43)));});}catch(_0xdb735b){_0x27dbc2(_0xdb735b),_0x4386bb[_0x25500d(0xd8)](_0x25500d(0xd9)+_0xdb735b);}});}function fetchOmniOutContentList(_0x2f241d,_0x557db2,_0x360104){return new Promise((_0x25897a,_0x3f9ea4)=>{const _0x565fc8=a34_0x2c3a;try{_0x360104[_0x565fc8(0xd8)](_0x565fc8(0xf2));const _0x462e46=[];let _0x177afc=0x1,_0x7a2f00=Promise[_0x565fc8(0x103)]();_0x557db2[_0x565fc8(0x109)](_0x69e0a7=>{const _0x4f22ad=_0x565fc8;_0x7a2f00=_0x7a2f00['then'](()=>fetchOmniOutContent(_0x2f241d,_0x69e0a7))[_0x4f22ad(0x11d)](_0x477709=>{const _0x45e3e5=_0x4f22ad;_0x477709&&_0x477709[_0x45e3e5(0xd4)]&&_0x477709[_0x45e3e5(0xd4)][_0x45e3e5(0xe0)]===0x2&&(_0x477709['compositeResponse'][0x0][_0x45e3e5(0xd2)]===0xc8&&_0x462e46['push']({'lwcComponentList':_0x477709[_0x45e3e5(0xd4)][0x1][_0x45e3e5(0xe3)][_0x45e3e5(0xee)],'name':_0x477709[_0x45e3e5(0xd4)][0x0][_0x45e3e5(0xe3)][_0x45e3e5(0xee)][0x0][_0x45e3e5(0xf8)]})),_0x360104[_0x45e3e5(0xd8)]('Process\x20Fetch\x20OmniOut\x20Content,\x20processed\x20'+_0x177afc++ +_0x45e3e5(0xef)+_0x462e46['length']+_0x45e3e5(0x114)+_0x557db2['length']);});}),_0x7a2f00[_0x565fc8(0x11d)](()=>{const _0x58fdc5=_0x565fc8;_0x360104['log'](_0x58fdc5(0xd5)),_0x25897a(_0x462e46);})['catch'](_0x5eb91c=>{const _0x2e20c2=_0x565fc8;_0x360104[_0x2e20c2(0xd8)](_0x2e20c2(0x115)+_0x5eb91c),_0x3f9ea4(_0x5eb91c);});}catch(_0x40ca55){_0x3f9ea4(_0x40ca55),_0x360104['log'](_0x565fc8(0x115)+_0x40ca55);}});}function fetchOmniOutContent(_0x1c673e,_0x301878){const _0x2e650e=a34_0x370aac;_0x301878=_0x301878[_0x2e650e(0xf7)]('-','')[_0x2e650e(0xf7)]('vlocity_cmt__','');const _0x23a2e5={'allOrNone':!![],'compositeRequest':[{'method':_0x2e650e(0x11b),'referenceId':_0x2e650e(0xf9),'url':_0x2e650e(0xe7)+_0x301878+'\x27'},{'method':_0x2e650e(0x11b),'referenceId':_0x2e650e(0x129),'url':_0x2e650e(0x10a)}]},_0x2b50be=_0x1c673e['instanceUrl'],_0x48f08f={'method':_0x2e650e(0xf6),'url':_0x2b50be+_0x2e650e(0x104),'body':JSON[_0x2e650e(0x107)](_0x23a2e5),'headers':{'Content-Type':_0x2e650e(0xfc)}};return _0x1c673e[_0x2e650e(0x102)](_0x48f08f);}function createLwcFiles(_0xb24212,_0xf66e51,_0x32e929,_0x4f283c){return new Promise((_0xf5cd3a,_0xf99e82)=>{const _0x2207bd=a34_0x2c3a;try{_0x4f283c[_0x2207bd(0xd8)](_0x2207bd(0xe4));const _0x2aa8cf=[];let _0x4073cc=[],_0x438f99=0x0,_0x383ce3=new AdmZip();_0xf66e51['forEach'](_0x40c2c4=>{const _0xe14eef=_0x2207bd;_0x4073cc[_0xe14eef(0x106)]({'apiName':_0x40c2c4[_0xe14eef(0x120)],'componentType':_0xe14eef(0x10f),'label':'lwc/'+_0x40c2c4[_0xe14eef(0x120)]}),_0x40c2c4[_0xe14eef(0xff)][_0xe14eef(0x109)](_0x458b6d=>{const _0x762661=_0xe14eef;_0x458b6d[_0x762661(0xe1)]!==_0x762661(0xfa)&&(_0x438f99+=_0x458b6d[_0x762661(0xe1)][_0x762661(0xe0)],_0x438f99<constants['MAX_SIZE_UNZIP_ATTACHMENT']?_0x383ce3[_0x762661(0x10e)](''+_0x458b6d['FilePath'],Buffer[_0x762661(0x127)](_0x458b6d['Source'][_0x762661(0xf7)](new RegExp(_0x762661(0x123),'g'),'c'))):(_0x2aa8cf[_0x762661(0x106)]({'snapshotId':_0x32e929,'typeList':[{'type':_0x762661(0x10f),'zip':_0x383ce3[_0x762661(0xf1)]()[_0x762661(0x112)]('base64'),'componentList':_0x4073cc}]}),_0x4073cc=[],_0x438f99=0x0,_0x383ce3=new AdmZip()));}),delete _0x40c2c4[_0xe14eef(0xff)];}),_0x4073cc[_0x2207bd(0xe0)]&&_0x2aa8cf[_0x2207bd(0x106)]({'snapshotId':_0x32e929,'typeList':[{'type':_0x2207bd(0x10f),'zip':_0x383ce3[_0x2207bd(0xf1)]()['toString'](_0x2207bd(0x118)),'componentList':_0x4073cc}]}),_0x4f283c[_0x2207bd(0xd8)]('End\x20Create\x20Lwc\x20Files'),_0xf5cd3a(_0x2aa8cf);}catch(_0x4f3971){_0x4f283c[_0x2207bd(0xd8)](_0x2207bd(0x100)+_0x4f3971),_0xf99e82(_0x4f3971);}});}function sendComponents(_0x75d189,_0x567844,_0x3fa8b8,_0x3033f3){return new Promise((_0x746f8b,_0x1d6fc4)=>{const _0x112898=a34_0x2c3a;try{_0x3033f3['log'](_0x112898(0x117));let _0x2aae69=Promise['resolve']();_0x3fa8b8[_0x112898(0x109)](_0x22d075=>{const _0x30ec55=_0x112898;_0x2aae69=_0x2aae69[_0x30ec55(0x11d)](()=>callSentComponents(_0x75d189,_0x567844,_0x22d075));}),_0x2aae69[_0x112898(0x11d)](()=>{const _0x266b0f=_0x112898;_0x3033f3[_0x266b0f(0xd8)](_0x266b0f(0x10c)),_0x746f8b();})[_0x112898(0xd3)](_0x209b2e=>{const _0x211d2b=_0x112898;_0x3033f3[_0x211d2b(0xd8)](_0x211d2b(0x116)+_0x209b2e),_0x1d6fc4(_0x209b2e);});}catch(_0x526a76){_0x3033f3[_0x112898(0xd8)]('Error\x20Send\x20Components\x20'+_0x526a76),_0x1d6fc4(_0x526a76);}});}function callSentComponents(_0xf720e3,_0x208853,_0x30c02e){return new Promise((_0x2766a6,_0xb5c9ad)=>{const _0x3c36ee=a34_0x2c3a;try{const _0xceb89e={'methodType':constants['METHOD_TYPE_ADD_COMPONENTS_TO_SNAPSHOT'],'body':JSON[_0x3c36ee(0x107)](_0x30c02e)};http[_0x3c36ee(0xd0)](_0xf720e3,_0x208853[_0x3c36ee(0xf7)]('__',''),JSON[_0x3c36ee(0x107)](_0xceb89e))['then'](()=>{_0x2766a6();})[_0x3c36ee(0xd3)](_0xb5c9ad);}catch(_0x42bafc){_0xb5c9ad(_0x42bafc);}});}function a34_0x18a5(){const _0x2f112b=['stringify','12YdBPuv','forEach','/services/data/v48.0/tooling/query?q=SELECT+Id,FilePath,Format,Source+FROM+LightningComponentResource+WHERE+LightningComponentBundleId=\x27@{bundleInfo.records[0].Id}\x27','lwcName','End\x20Send\x20Components','Start\x20Update\x20Snapshot','addFile','LightningComponentBundle','filter','End\x20Get\x20Dependency\x20List\x20','toString','eleArray',',\x20all\x20','Error\x20Fetch\x20OmniOut\x20Content\x20List\x20','Error\x20Send\x20Components\x20','Start\x20Send\x20Components','base64','propSetMap','getAttachmentBody','GET','2438576nVtgtr','then','path','vlocity_cmt__Language__c','name','665991MifNjC','apex','vlocity_cmt','lwcComponentOverride','parse','End\x20Query','from','Error\x20Get\x20Dependency\x20List\x20','bundleResources','Process\x20Get\x20Dependency,\x20processed\x20','End\x20Update\x20Snapshot','/vlocity_cmt/v1/GenericInvoke/','Start\x20Get\x20Dependency\x20List\x20','post','type','httpStatusCode','catch','compositeResponse','End\x20Fetch\x20OmniOut\x20Content\x20List\x20','Error\x20Update\x20Snapshot','vlocity_cmt__Type__c','log','Error\x20Query\x20','Is_Error__c','8946310VGMSyh','adm-zip','exports','updateSnapshot','\x20from\x20','length','Source','Custom\x20Lightning\x20Web\x20Component','body','Start\x20Create\x20Lwc\x20Files','Is_Completed__c','3017066SStWmD','/services/data/v48.0/tooling/query?q=SELECT+Id,DeveloperName,Description+FROM+LightningComponentBundle+WHERE+DeveloperName=\x27','Error\x20getPrefilledJSON\x20','576565sNBhbi','children','8994588XZhDDT','1421270buAJco','Vlocity\x20BuildJSONWithPrefill','records',',\x20retrieved\x20','fs-extra','toBuffer','Start\x20Fetch\x20OmniOut\x20Content\x20List\x20','../../../services/http','24EJvczw','elementTypeToLwcTemplateMapping','POST','replace','DeveloperName','bundleInfo','(hidden)','45YaQXAA','application/json','vlocity_cmt__SubType__c','callUpdateLog','lwcComponentList','Error\x20Create\x20Lwc\x20Files\x20','Error\x20Get\x20Prefilled\x20JSON\x20','request','resolve','/services/data/v50.0/tooling/composite','Error\x20Extract\x20LWC\x20Dependencies\x20','push'];a34_0x18a5=function(){return _0x2f112b;};return a34_0x18a5();}function completeDeployment(_0x3764bd,_0x53fd85,_0x5afbe4,_0x1ad61a,_0x1a2df2,_0x1de07e,_0xcca4b6,_0x39abd2,_0xde5828=![]){return new Promise((_0x345091,_0x8daec)=>{const _0x904408=a34_0x2c3a;try{Promise[_0x904408(0x103)]()[_0x904408(0x11d)](()=>updateAttachmentLog(_0x3764bd,_0x53fd85,_0x1de07e,_0x39abd2,_0xde5828,!![]))[_0x904408(0x11d)](_0x3e1137=>{const _0x3ba165=_0x904408;return _0xde5828=_0x3e1137,http[_0x3ba165(0xfe)](_0x53fd85,_0x1a2df2,_0x5afbe4,_0xcca4b6,_0x39abd2,_0x3e1137);})[_0x904408(0x11d)](()=>callUpdateSnapshot(_0x53fd85,_0x1ad61a,_0x5afbe4,_0xde5828,_0x39abd2));}catch(_0x20cf50){_0x8daec(_0x20cf50);}});}function updateAttachmentLog(_0x281b4d,_0x5c08b3,_0x510d1d,_0xd228df,_0x29034e,_0x42663a=![]){return new Promise(_0x25645b=>{const _0x162ef5=a34_0x2c3a;try{_0xd228df[_0x162ef5(0xd8)]('Start\x20Update\x20Attachment\x20Log'),Promise[_0x162ef5(0x103)]()['then'](()=>http[_0x162ef5(0x11a)](_0x5c08b3,_0x510d1d,_0xd228df))[_0x162ef5(0x11d)](_0x4133ed=>http['callUpdateAttachmentLog'](_0x5c08b3,_0x510d1d,_0x4133ed,_0xd228df,_0x29034e))[_0x162ef5(0x11d)](()=>_0x25645b(_0x29034e))[_0x162ef5(0xd3)](()=>_0x25645b(_0x29034e));}catch(_0x719d5d){_0xd228df[_0x162ef5(0xd8)]('Error\x20Update\x20Attachment\x20Log\x20'+_0x719d5d),_0x25645b(_0x29034e);}});}function callUpdateSnapshot(_0x3e3157,_0x3b0dec,_0x494354,_0x56e3b3,_0xa61a83){return new Promise((_0x19591d,_0x3ac94d)=>{const _0x2c085d=a34_0x2c3a;try{_0xa61a83[_0x2c085d(0xd8)](_0x2c085d(0x10d));const _0x3b2c9f={'Id':_0x3b0dec,[_0x494354+_0x2c085d(0xe5)]:!![],[_0x494354+_0x2c085d(0xda)]:_0x56e3b3};_0x3e3157[_0x2c085d(0xde)](_0x494354,_0x3b2c9f)[_0x2c085d(0x11d)](()=>{const _0x36495f=_0x2c085d;_0xa61a83[_0x36495f(0xd8)](_0x36495f(0xcd)),_0x19591d();})[_0x2c085d(0xd3)](_0x4e4118=>{const _0x380e30=_0x2c085d;_0xa61a83[_0x380e30(0xd8)](_0x380e30(0xd6)),_0x3ac94d(_0x4e4118);});}catch(_0x24a431){_0xa61a83[_0x2c085d(0xd8)](_0x2c085d(0xd6)),_0x3ac94d(_0x24a431);}});}function getDependencyList(_0x5b0255,_0x5b530b,_0x35dd3d){return new Promise((_0x31f925,_0x27bd9f)=>{const _0x365a35=a34_0x2c3a;try{_0x35dd3d['log'](_0x365a35(0xcf));const _0x5839f0=[];let _0x32c340=Promise[_0x365a35(0x103)]();_0x5b530b['forEach'](_0x3a3844=>{const _0xae6544=_0x365a35;_0x32c340=_0x32c340['then'](()=>getPrefilledJSON(_0x5b0255,_0x3a3844,_0x35dd3d))[_0xae6544(0x11d)](_0x5e1046=>{const _0x420616=_0xae6544;_0x5839f0['push'](_0x5e1046),_0x35dd3d[_0x420616(0xd8)](_0x420616(0xcc)+_0x5839f0[_0x420616(0xe0)]+_0x420616(0xdf)+_0x5b530b[_0x420616(0xe0)]);});}),_0x32c340['then'](()=>{const _0x443588=_0x365a35;_0x35dd3d[_0x443588(0xd8)](_0x443588(0x111)),_0x31f925(_0x5839f0);})['catch'](_0x196bce=>{const _0x23b1e4=_0x365a35;_0x35dd3d['log'](_0x23b1e4(0x128)+_0x196bce),_0x27bd9f(_0x196bce);});}catch(_0x44f27a){_0x35dd3d[_0x365a35(0xd8)](_0x365a35(0x128)+_0x44f27a),_0x27bd9f(_0x44f27a);}});}function getPrefilledJSON(_0x102203,_0x3c6698,_0x3a4e9f){return new Promise((_0x528104,_0x4ed252)=>{const _0xd6f69f=a34_0x2c3a;try{const _0x1dc758={'sClassName':_0xd6f69f(0xed),'sType':_0x3c6698['vlocity_cmt__Type__c'],'sSubType':_0x3c6698[_0xd6f69f(0xfd)],'sLang':_0x3c6698[_0xd6f69f(0x11f)]};_0x102203[_0xd6f69f(0x122)][_0xd6f69f(0xd0)](_0xd6f69f(0xce),_0x1dc758,(_0x1fa355,_0x534c60)=>{const _0x99ce9=_0xd6f69f;_0x1fa355?(_0x3a4e9f[_0x99ce9(0xd8)](_0x99ce9(0xe8)+_0x1fa355),_0x4ed252(_0x1fa355)):_0x528104(JSON[_0x99ce9(0x125)](_0x534c60));});}catch(_0x31985d){_0x4ed252(_0x31985d),_0x3a4e9f[_0xd6f69f(0xd8)](_0xd6f69f(0x101)+_0x31985d);}});}function extractLwcDependencies(_0x3a8e6c,_0x27f2b7){return new Promise((_0x63adc2,_0x5a41b9)=>{const _0x5dc4fe=a34_0x2c3a;try{_0x27f2b7[_0x5dc4fe(0xd8)]('Start\x20Extract\x20LWC\x20Dependencies');const _0x2d7f83=[];_0x3a8e6c[_0x5dc4fe(0x109)](_0x130659=>{const _0x4b36ed=_0x5dc4fe;_0x130659[_0x4b36ed(0xea)]&&_0x130659['children'][_0x4b36ed(0xe0)]>0x0&&_0x130659[_0x4b36ed(0xea)][_0x4b36ed(0x109)](_0x5ed14e=>{const _0x347031=_0x4b36ed;_0x5ed14e[_0x347031(0xea)]&&_0x5ed14e[_0x347031(0xea)]['length']>0x0&&_0x5ed14e[_0x347031(0xea)][_0x347031(0x109)](_0x5a558d=>{const _0xbb1fa1=_0x347031;_0x5a558d[_0xbb1fa1(0x113)][0x0][_0xbb1fa1(0xd1)]===_0xbb1fa1(0xe2)&&_0x2d7f83[_0xbb1fa1(0x106)](_0x5a558d[_0xbb1fa1(0x113)][0x0][_0xbb1fa1(0x119)][_0xbb1fa1(0x10b)]);});});if(_0x130659[_0x4b36ed(0x119)]&&_0x130659[_0x4b36ed(0x119)][_0x4b36ed(0xf5)])for(const [_0xc9e745,_0x331053]of Object['entries'](_0x130659[_0x4b36ed(0x119)]['elementTypeToLwcTemplateMapping'])){_0x2d7f83['push'](_0x331053);}_0x130659[_0x4b36ed(0xea)]&&_0x130659['children'][_0x4b36ed(0xe0)]>0x0&&_0x130659[_0x4b36ed(0xea)][_0x4b36ed(0x109)](_0x30b110=>{const _0x481baa=_0x4b36ed;_0x30b110[_0x481baa(0x119)]&&_0x30b110[_0x481baa(0x119)]['lwcComponentOverride']&&_0x2d7f83[_0x481baa(0x106)](_0x30b110[_0x481baa(0x119)][_0x481baa(0x124)]),_0x30b110[_0x481baa(0xea)]&&_0x30b110['children'][_0x481baa(0xe0)]>0x0&&_0x30b110[_0x481baa(0xea)][_0x481baa(0x109)](_0x4d25dd=>{const _0x287cc0=_0x481baa;_0x4d25dd[_0x287cc0(0x113)][0x0][_0x287cc0(0x119)]&&_0x4d25dd['eleArray'][0x0][_0x287cc0(0x119)][_0x287cc0(0x124)]&&_0x2d7f83['push'](_0x4d25dd[_0x287cc0(0x113)][0x0][_0x287cc0(0x119)]['lwcComponentOverride']);});});}),_0x27f2b7[_0x5dc4fe(0xd8)]('End\x20Extract\x20LWC\x20Dependencies'),_0x63adc2(_0x2d7f83);}catch(_0x31a2dd){_0x27f2b7[_0x5dc4fe(0xd8)](_0x5dc4fe(0x105)+_0x31a2dd),_0x5a41b9(_0x31a2dd);}});}function a34_0x2c3a(_0x4e91c9,_0x4bdbcc){const _0x18a5d6=a34_0x18a5();return a34_0x2c3a=function(_0x2c3a98,_0x3a9038){_0x2c3a98=_0x2c3a98-0xcc;let _0x4d1416=_0x18a5d6[_0x2c3a98];return _0x4d1416;},a34_0x2c3a(_0x4e91c9,_0x4bdbcc);}module[a34_0x370aac(0xdd)]={'query':query,'getDependencyList':getDependencyList,'extractLwcDependencies':extractLwcDependencies,'fetchOmniOutContentList':fetchOmniOutContentList,'createLwcFiles':createLwcFiles,'sendComponents':sendComponents,'completeDeployment':completeDeployment};