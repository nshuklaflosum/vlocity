const a27_0x25c61a=a27_0x2573;(function(_0x1feb40,_0x53d93e){const _0x5be7d2=a27_0x2573,_0x28c0e8=_0x1feb40();while(!![]){try{const _0x3761f3=-parseInt(_0x5be7d2(0x206))/0x1*(parseInt(_0x5be7d2(0x1f7))/0x2)+parseInt(_0x5be7d2(0x20c))/0x3+parseInt(_0x5be7d2(0x20b))/0x4*(-parseInt(_0x5be7d2(0x1fa))/0x5)+parseInt(_0x5be7d2(0x21c))/0x6*(-parseInt(_0x5be7d2(0x1f5))/0x7)+-parseInt(_0x5be7d2(0x1f3))/0x8+parseInt(_0x5be7d2(0x20f))/0x9+parseInt(_0x5be7d2(0x213))/0xa;if(_0x3761f3===_0x53d93e)break;else _0x28c0e8['push'](_0x28c0e8['shift']());}catch(_0x2b288f){_0x28c0e8['push'](_0x28c0e8['shift']());}}}(a27_0x3558,0x92f81));const AdmZip=require('adm-zip'),childProcess=require(a27_0x25c61a(0x21f)),constants=require(a27_0x25c61a(0x1ff)),http=require('../../../services/http');function a27_0x2573(_0x1c6353,_0x5f14a7){const _0x355819=a27_0x3558();return a27_0x2573=function(_0x2573d1,_0x15a745){_0x2573d1=_0x2573d1-0x1e4;let _0x3d247d=_0x355819[_0x2573d1];return _0x3d247d;},a27_0x2573(_0x1c6353,_0x5f14a7);}async function retrieveSourceComponents(_0x9e8417,_0x271dbe,_0x924ce1,_0xe58d34){const _0x1c8e0e=a27_0x25c61a;_0xe58d34[_0x1c8e0e(0x1f2)](_0x1c8e0e(0x1fb));const _0x4d8af0=[];let _0x1d607d=![];const _0x36aeff='SELECT\x20Id\x20FROM\x20'+_0x271dbe+_0x1c8e0e(0x208)+_0x271dbe+_0x1c8e0e(0x217)+_0x924ce1+'\x27';let _0x265123=await _0x9e8417[_0x1c8e0e(0x218)](_0x36aeff);_0x4d8af0[_0x1c8e0e(0x204)](..._0x265123['records']['map'](({Id:_0x568860})=>_0x568860)),_0xe58d34['log'](_0x1c8e0e(0x1eb)+_0x265123[_0x1c8e0e(0x1ea)]);do{_0x265123=await _0x9e8417[_0x1c8e0e(0x205)](_0x265123[_0x1c8e0e(0x1ed)]),_0x4d8af0['push'](..._0x265123[_0x1c8e0e(0x221)][_0x1c8e0e(0x1e6)](({Id:_0x300a41})=>_0x300a41)),_0xe58d34['log'](_0x1c8e0e(0x1eb)+_0x265123[_0x1c8e0e(0x1ea)]),_0x1d607d=!_0x265123[_0x1c8e0e(0x216)];}while(_0x1d607d);return _0xe58d34['log']('End\x20Retrieve\x20Components\x20Ids'),_0x4d8af0;}function retrieveVlocityAttachments(_0x354883,_0x21ff9c,_0x3fcfdf,_0x5c1672,_0x3893aa=[]){return new Promise((_0x56e371,_0x1726d5)=>{const _0x1c2591=a27_0x2573;try{_0x5c1672[_0x1c2591(0x1f2)](_0x1c2591(0x1f0)),callRetrieveVlocityAttachments(_0x354883,_0x21ff9c,_0x3fcfdf,_0x3fcfdf[_0x1c2591(0x1ea)],_0x5c1672,_0x3893aa=[])[_0x1c2591(0x1f9)](_0x181e24=>{const _0x2a4101=_0x1c2591;_0x5c1672[_0x2a4101(0x1f2)](_0x2a4101(0x210)),_0x56e371(_0x181e24);})[_0x1c2591(0x1f8)](_0x543aa0=>{const _0x3c0bc2=_0x1c2591;_0x5c1672[_0x3c0bc2(0x1f2)](_0x3c0bc2(0x1e7)),_0x1726d5(_0x543aa0);});}catch(_0x19453b){_0x5c1672['log'](_0x1c2591(0x1e7)),_0x1726d5(_0x19453b);}});}function a27_0x3558(){const _0x1d1e1f=['7GzJIGS','Error\x20Unzip\x20Component\x20List\x20','39998diXluO','catch','then','5JapfsF','Start\x20Retrieve\x20Components\x20Ids','toFixed','JOB_FILE_NAME','getMinutes','../../../constants','-job','resolve','-sf.accessToken','join','push','queryMore','59JYQUMq','forEach','Patch_Manifest__c\x20WHERE\x20','getMonth','packDeploy','1530772rTJpmq','3559734GafFPe','getSeconds','-separateCalculationProcedureVersions','1318068RkjOeX','End\x20Retrieve\x20Vlocity\x20Attachments','Error\x20Deploy\x20Data\x20','End\x20Deploy\x20Data','25397890KzTvpj','base64','slice','done','Patch__c\x20=\x20\x27','query','0$1','callChildProcess','getDate','6870222HFySvO','extractAllTo','UNZIP_CATALOG_NAME','../../../services/child-process','getHours','records','runApex','-autoRetryErrors','map','Error\x20Retrieve\x20Vlocity\x20Attachments','getFullYear','End\x20Unzip\x20Component\x20List','length','Component\x20Id\x20List\x20Length,\x20','toString','nextRecordsUrl','parseFloat','ids','Start\x20Retrieve\x20Vlocity\x20Attachments','Start\x20Deploy\x20Data','log','4505304fYYFrI','-apex'];a27_0x3558=function(){return _0x1d1e1f;};return a27_0x3558();}async function callRetrieveVlocityAttachments(_0x6d8b18,_0x123e7b,_0x5f0de8,_0x23dc41,_0x14adfb,_0x338cea=[]){const _0x3c7706=a27_0x25c61a,_0x1d7a8e={'parentIds':_0x5f0de8},_0x329675=await http['post'](_0x6d8b18,_0x123e7b,_0x1d7a8e,'GetVlocityComponents/');_0x338cea['push'](..._0x329675[_0x3c7706(0x221)]),_0x14adfb['log']('Retrieved:\x20'+Number[_0x3c7706(0x1ee)](_0x338cea['length']/_0x23dc41*0x64)[_0x3c7706(0x1fc)](0x2)+'%');if(_0x329675[_0x3c7706(0x1ef)][_0x3c7706(0x1ea)]&&_0x5f0de8[_0x3c7706(0x1ea)]!==_0x338cea[_0x3c7706(0x1ea)])return await callRetrieveVlocityAttachments(_0x6d8b18,_0x123e7b,_0x329675[_0x3c7706(0x1ef)],_0x23dc41,_0x14adfb,_0x338cea);return _0x338cea;}function unzipComponentList(_0x22d7ea,_0x166960,_0xd6c8ca){return new Promise((_0x2c48b3,_0x286400)=>{const _0x3bbedd=a27_0x2573;try{_0xd6c8ca[_0x3bbedd(0x1f2)]('Start\x20Unzip\x20Component\x20List');let _0x3139d1=Promise[_0x3bbedd(0x201)]();_0x22d7ea['forEach'](_0x5ae41b=>{const _0x4f657c=_0x3bbedd;_0x3139d1=_0x3139d1[_0x4f657c(0x1f9)](()=>unzipBuffer(_0x5ae41b,_0x166960));}),_0x3139d1[_0x3bbedd(0x1f9)](()=>{const _0x44523d=_0x3bbedd;_0xd6c8ca[_0x44523d(0x1f2)](_0x44523d(0x1e9)),_0x2c48b3();})['catch'](_0xed24e1=>{const _0x1d8df7=_0x3bbedd;_0xd6c8ca[_0x1d8df7(0x1f2)]('Error\x20Unzip\x20Component\x20List\x20'+_0xed24e1),_0x286400(_0xed24e1);});}catch(_0x9bf5c1){_0xd6c8ca[_0x3bbedd(0x1f2)](_0x3bbedd(0x1f6)+_0x9bf5c1),_0x286400(_0x9bf5c1);}});}function unzipBuffer(_0x58805a,_0x57297d){return new Promise((_0x54a6bf,_0x57a098)=>{const _0x1ca0b=a27_0x2573;try{const _0x25965=new AdmZip(Buffer['from'](_0x58805a,_0x1ca0b(0x214))),_0x521ea3=_0x57297d+'/'+constants[_0x1ca0b(0x21e)];_0x25965[_0x1ca0b(0x21d)](_0x521ea3,![]),_0x54a6bf();}catch(_0x33e07a){_0x57a098(_0x33e07a);}});}function deployData(_0x47d9eb,_0x1093eb,_0x8b0d8,_0x21e62d,_0x41079b,_0x2c77d4,_0x41652c,_0xee45a8){return new Promise((_0x2a0512,_0x186e71)=>{const _0x4c2ec7=a27_0x2573;try{_0xee45a8['log'](_0x4c2ec7(0x1f1));const _0x59b9a2='vlocity',_0x227346=[_0x4c2ec7(0x202),''+_0x8b0d8,'-sf.instanceUrl',''+_0x1093eb,_0x4c2ec7(0x200),''+constants[_0x4c2ec7(0x1fd)],_0x4c2ec7(0x1e5)];_0x21e62d&&_0x227346[_0x4c2ec7(0x204)]('-separateMatrixVersions');_0x41079b&&_0x227346['push'](_0x4c2ec7(0x20e));_0x227346[_0x4c2ec7(0x204)](_0x4c2ec7(0x20a));_0x2c77d4&&(_0x227346['push'](_0x4c2ec7(0x1e4)),_0x227346[_0x4c2ec7(0x204)](_0x4c2ec7(0x1f4)),_0x227346[_0x4c2ec7(0x204)](_0x41652c));_0xee45a8[_0x4c2ec7(0x1f2)](_0x227346[_0x4c2ec7(0x215)](0x2)[_0x4c2ec7(0x203)]('\x20'));const _0x302d32={'cwd':_0x47d9eb,'maxBuffer':0x400*0x1f4,'shell':!![]};childProcess[_0x4c2ec7(0x21a)](_0x59b9a2,_0x227346,_0xee45a8,_0x302d32)[_0x4c2ec7(0x1f9)](_0x391438=>{const _0x24a392=_0x4c2ec7;_0xee45a8[_0x24a392(0x1f2)](_0x24a392(0x212)),_0x2a0512(_0x391438);})[_0x4c2ec7(0x1f8)](_0x4e4c54=>{const _0x4b75fd=_0x4c2ec7;_0xee45a8['log'](_0x4b75fd(0x211)+_0x4e4c54),_0x186e71(_0x4e4c54);});}catch(_0x84def1){_0x186e71(_0x84def1);}});}function getTime(){const _0x536e0f=a27_0x25c61a,_0x22d37d=new Date(),_0x5f1153=[_0x22d37d[_0x536e0f(0x21b)](),_0x22d37d[_0x536e0f(0x209)]()+0x1,_0x22d37d[_0x536e0f(0x1e8)](),_0x22d37d[_0x536e0f(0x220)](),_0x22d37d[_0x536e0f(0x1fe)](),_0x22d37d[_0x536e0f(0x20d)]()];return _0x5f1153[_0x536e0f(0x207)](_0x461837=>_0x461837=_0x461837[_0x536e0f(0x1ec)]()['replace'](/^([0-9])$/,_0x536e0f(0x219))),_0x5f1153[0x2]+'-'+_0x5f1153[0x1]+'-'+_0x5f1153[0x0]+'\x20'+_0x5f1153[0x3]+':'+_0x5f1153[0x4]+':'+_0x5f1153[0x5];}module['exports']={'retrieveSourceComponents':retrieveSourceComponents,'retrieveVlocityAttachments':retrieveVlocityAttachments,'unzipComponentList':unzipComponentList,'deployData':deployData,'getTime':getTime};