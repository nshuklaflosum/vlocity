const a14_0xb114aa=a14_0x2165;(function(_0x166ba4,_0x3ad647){const _0x110195=a14_0x2165,_0x3dde8b=_0x166ba4();while(!![]){try{const _0x1da7aa=-parseInt(_0x110195(0xca))/0x1*(-parseInt(_0x110195(0xba))/0x2)+parseInt(_0x110195(0xd7))/0x3*(-parseInt(_0x110195(0xec))/0x4)+parseInt(_0x110195(0xc2))/0x5*(-parseInt(_0x110195(0xeb))/0x6)+-parseInt(_0x110195(0xe2))/0x7+-parseInt(_0x110195(0xb4))/0x8+parseInt(_0x110195(0xe1))/0x9+parseInt(_0x110195(0xb2))/0xa;if(_0x1da7aa===_0x3ad647)break;else _0x3dde8b['push'](_0x3dde8b['shift']());}catch(_0x17393b){_0x3dde8b['push'](_0x3dde8b['shift']());}}}(a14_0x5cbf,0x93f19));function a14_0x2165(_0x588c6b,_0x4b869c){const _0x5cbff2=a14_0x5cbf();return a14_0x2165=function(_0x216574,_0x38f757){_0x216574=_0x216574-0xb2;let _0x38bdb5=_0x5cbff2[_0x216574];return _0x38bdb5;},a14_0x2165(_0x588c6b,_0x4b869c);}function a14_0x5cbf(){const _0x1e74dc=['88aQbUiL','METHOD_BACKUP_LOG','Error\x20Create\x20Job\x20File','22777050ipnxVU','-job','4919632sWTtUW','Start\x20Deploy\x20Data','\x20\x20\x20\x20query:\x20Select\x20Id\x20from\x20','Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.\x0a','keys','1052oFpyfH','exports','-sf.accessToken','/services/apexrest/','join','toBuffer','slice','Error\x20Deploy\x20Data','1646605rgNvGw','toString','resolve','Start\x20Prepare\x20Data\x20For\x20Deploy','isStartDeploy','push','Components\x20not\x20found!','Start\x20Create\x20Job\x20File','1153yNvzrM','Error\x20Retrieve\x20Data\x20','Error\x20Prepare\x20Data\x20For\x20Deploy','End\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','UNZIP_CATALOG_NAME','Error\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','End\x20Deploy\x20Data','readdirSync','catch','log','%\x27\x0a','post','SOURCE_FOLDER','52407QEKHBi','name','stringify','packExport','replace','base64','length','METHOD_BACKUP_LOG_ERROR','-maxDepth','JOB_FILE_NAME','1091043tXprJz','2885386rWXeur','adm-zip','then','../../../services/http','METHOD_NEXT_VLOCITY_CONTINUE_DEPLOY_STEP','forEach','../../../services/child-process','addLocalFolder','Start\x20Retrieve\x20Data','18qTrgUN'];a14_0x5cbf=function(){return _0x1e74dc;};return a14_0x5cbf();}const fs=require('fs'),AdmZip=require(a14_0xb114aa(0xe3)),childProcess=require(a14_0xb114aa(0xe8)),constants=require('../../../constants'),http=require(a14_0xb114aa(0xe5));function createJobFileRollback(_0x53471e,_0x3aebe6,_0x172df2,_0x55ffd3){return new Promise((_0xafd974,_0x50424b)=>{const _0x490924=a14_0x2165;try{_0x55ffd3['log'](_0x490924(0xc9));let _0x1ee7c5='projectPath:\x20./'+constants[_0x490924(0xce)]+'\x0aqueries:\x0a';Object[_0x490924(0xb9)](_0x3aebe6)['forEach'](_0x12722e=>{const _0x3fdc32=_0x490924;_0x3aebe6[_0x12722e][_0x3fdc32(0xe7)](_0x382307=>{const _0x4d416b=_0x3fdc32;constants['DATA_PACK_TYPES_QUERIES_MAP'][_0x12722e][_0x4d416b(0xe7)](_0x3e1d31=>{const _0x9f1bdc=_0x4d416b;_0x1ee7c5+='\x20\x20-\x20VlocityDataPackType:\x20'+_0x12722e+'\x0a',_0x1ee7c5+=_0x9f1bdc(0xb6)+_0x3e1d31+'\x20where\x20Name\x20LIKE\x20\x27%'+_0x382307+_0x9f1bdc(0xd4);});});}),fs['appendFileSync'](_0x53471e+'/'+constants[_0x490924(0xe0)],_0x1ee7c5),_0x55ffd3[_0x490924(0xd3)]('End\x20Create\x20Job\x20File'),_0xafd974();}catch(_0xc4d2ff){_0x55ffd3['log'](_0x490924(0xee)),_0x50424b(_0xc4d2ff);}});}function retrieveData(_0x41bdde,_0x548e37,_0x47ce95,_0x7e2c74){return new Promise((_0x42a04f,_0x3e6faa)=>{const _0x1aedf5=a14_0x2165;try{_0x7e2c74[_0x1aedf5(0xd3)](_0x1aedf5(0xea));const _0x5f4f91='vlocity',_0x129c68=[_0x1aedf5(0xbc),''+_0x47ce95,'-sf.instanceUrl',''+_0x548e37,_0x1aedf5(0xb3),''+constants[_0x1aedf5(0xe0)],'-autoRetryErrors',_0x1aedf5(0xdf),'0',_0x1aedf5(0xda)];_0x7e2c74[_0x1aedf5(0xd3)](_0x129c68[_0x1aedf5(0xc0)](0x2)[_0x1aedf5(0xbe)]('\x20'));const _0x4eda1f={'cwd':''+_0x41bdde,'maxBuffer':0x400*0x1f4,'shell':!![]};childProcess['callChildProcess'](_0x5f4f91,_0x129c68,_0x7e2c74,_0x4eda1f)['then'](_0x225fde=>{_0x7e2c74['log']('End\x20Retrieve\x20Data'),_0x42a04f(_0x225fde);})[_0x1aedf5(0xd2)](_0x820cc=>{const _0x1bc362=_0x1aedf5;_0x7e2c74['log'](_0x1bc362(0xcb)+_0x820cc),_0x3e6faa(_0x820cc);});}catch(_0x578dcb){_0x3e6faa(_0x578dcb);}});}function prepareDataForDeploy(_0x2ad506,_0x4d047b){return new Promise((_0x38aa09,_0x4298f9)=>{const _0x8b7d4d=a14_0x2165;try{_0x4d047b[_0x8b7d4d(0xd3)](_0x8b7d4d(0xc5));const _0x4df7f9=_0x2ad506+'/'+constants[_0x8b7d4d(0xd6)];let _0xc42506=new AdmZip();const _0x25bba7=fs[_0x8b7d4d(0xd1)](_0x4df7f9,{'withFileTypes':!![]}),_0x25e3eb=[];_0x25bba7[_0x8b7d4d(0xe7)](_0x3eb1c2=>{const _0xb7ab9c=_0x8b7d4d;if(_0x3eb1c2['isDirectory']()){const _0xaab235=_0xc42506[_0xb7ab9c(0xbf)]()[_0xb7ab9c(0xc3)](_0xb7ab9c(0xdc));_0xaab235[_0xb7ab9c(0xdd)]>0x1e8480&&(_0x25e3eb['push'](_0xaab235),_0xc42506=new AdmZip()),_0xc42506[_0xb7ab9c(0xe9)](_0x4df7f9+'/'+_0x3eb1c2[_0xb7ab9c(0xd8)],_0x3eb1c2[_0xb7ab9c(0xd8)]);}}),_0x25e3eb[_0x8b7d4d(0xc7)](_0xc42506[_0x8b7d4d(0xbf)]()['toString'](_0x8b7d4d(0xdc))),_0x4d047b[_0x8b7d4d(0xd3)]('End\x20Prepare\x20Data\x20For\x20Deploy'),_0x38aa09(_0x25e3eb);}catch(_0x1062c6){_0x4d047b[_0x8b7d4d(0xd3)](_0x8b7d4d(0xcc)),_0x4298f9(_0x1062c6);}});}function deployData(_0x3c76c8,_0x3e6cea,_0xa476a7,_0x24e2f2,_0x29facd,_0x40eb30,_0x3ad63f,_0x314703){return new Promise((_0x5ba0d5,_0x1c067b)=>{const _0x1dab54=a14_0x2165;try{_0x314703[_0x1dab54(0xd3)](_0x1dab54(0xb5));const _0x133953={'zipBuffer':'','pipelineId':_0x29facd,'logId':_0xa476a7,'branchId':_0x3ad63f,'pipelineNumber':_0x40eb30};let _0x36520f=Promise[_0x1dab54(0xc4)](),_0x309771=0x1;_0x24e2f2[_0x1dab54(0xe7)](_0x47dccc=>{const _0x54fce0=_0x1dab54;_0x133953['zipBuffer']=_0x47dccc,_0x133953[_0x54fce0(0xc6)]=_0x309771===_0x24e2f2[_0x54fce0(0xdd)];const _0x302a2d={'methodType':constants[_0x54fce0(0xed)],'body':JSON['stringify'](_0x133953)};_0x36520f=_0x36520f[_0x54fce0(0xe4)](()=>postDeploy(_0x3c76c8,_0x3e6cea,_0x302a2d)),_0x309771++;}),_0x36520f[_0x1dab54(0xe4)](()=>{const _0x2063b2=_0x1dab54;_0x314703['log'](_0x2063b2(0xd0)),_0x5ba0d5();})[_0x1dab54(0xd2)](_0x3bab47=>{const _0x2499d1=_0x1dab54;_0x314703[_0x2499d1(0xd3)](_0x2499d1(0xc1)),_0x1c067b(_0x3bab47);});}catch(_0x4651ac){_0x314703[_0x1dab54(0xd3)](_0x1dab54(0xc1)),_0x1c067b(_0x4651ac);}});}function handleNoComponents(_0x2b9ace,_0x2fbb2a,_0x5cb3c7,_0x5db633,_0x5d37f8,_0x1b76fb,_0x575d21,_0x5d5888){return new Promise((_0x48cd8,_0x154ad8)=>{const _0x4bb674=a14_0x2165;try{_0x5d5888[_0x4bb674(0xd3)]('Start\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.'),_0x5cb3c7=_0x5cb3c7&&_0x5cb3c7[_0x4bb674(0xdd)]?_0x5cb3c7[_0x4bb674(0xdb)]('__','')+'/':'';const _0x6688da={'message':_0x4bb674(0xc8),'pipelineId':_0x5d37f8,'logId':_0x5db633,'branchId':_0x575d21,'pipelineNumber':_0x1b76fb,'isStartDeploy':!![]},_0x12a353=_0x2b9ace+_0x4bb674(0xbd)+_0x5cb3c7+'unlocked-packages',_0x321d5b={'methodType':constants[_0x4bb674(0xde)],'body':JSON[_0x4bb674(0xd9)](_0x6688da)};postDeploy(_0x12a353,_0x2fbb2a,_0x5cb3c7,_0x321d5b)[_0x4bb674(0xe4)](()=>{_0x5d5888['log']('End\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.'),_0x48cd8();})[_0x4bb674(0xd2)](_0x2f01e3=>{const _0x330804=_0x4bb674;_0x154ad8(_0x2f01e3),_0x5d5888[_0x330804(0xd3)](_0x330804(0xb8));});}catch(_0x1a86b5){_0x5d5888[_0x4bb674(0xd3)](_0x4bb674(0xb7)),_0x154ad8(_0x1a86b5);}});}function postDeploy(_0x4ad6ce,_0x1cf6f2,_0x3c89b3){return new Promise((_0xe7ce1,_0x3cbe1b)=>{const _0x2a629e=a14_0x2165;try{http['post'](_0x4ad6ce,_0x1cf6f2,_0x3c89b3)[_0x2a629e(0xe4)](_0x869957=>{_0xe7ce1(_0x869957);})[_0x2a629e(0xd2)](_0x3d204e=>{const _0x218946=_0x2a629e;console[_0x218946(0xd3)](_0x3d204e),_0x3cbe1b(_0x3d204e);});}catch(_0x567d00){_0x3cbe1b(_0x567d00);}});}function callContinuePipelineVlocityDeploy(_0x49bc22,_0x115bfd,_0x1dbc7a,_0xfea8da,_0x2b30b1,_0x13969c,_0xf333d6,_0x47bc4e){return new Promise((_0x43ff98,_0x42ebe5)=>{const _0x118531=a14_0x2165;try{_0x115bfd=_0x115bfd&&_0x115bfd[_0x118531(0xdd)]?_0x115bfd[_0x118531(0xdb)]('__','')+'/':'',_0x47bc4e[_0x118531(0xd3)]('Start\x20Continue\x20Vlocity\x20Pipeline\x20Deploy');const _0x514a12={'pipelineId':_0x1dbc7a,'pipelineNumber':_0xfea8da,'logId':_0xf333d6,'branchId':_0x13969c,'pipelineKey':_0x2b30b1},_0x57db52={'methodType':constants[_0x118531(0xe6)],'body':JSON['stringify'](_0x514a12)};http[_0x118531(0xd5)](_0x49bc22,_0x115bfd,_0x57db52)['then'](_0x671030=>{const _0x13a61c=_0x118531;_0x47bc4e[_0x13a61c(0xd3)](_0x13a61c(0xcd)),_0x43ff98(_0x671030);})[_0x118531(0xd2)](_0x2ddf2e=>{const _0x4f09b2=_0x118531;_0x47bc4e[_0x4f09b2(0xd3)](_0x4f09b2(0xcf)),_0x42ebe5(_0x2ddf2e);});}catch(_0x1139fb){_0x42ebe5(_0x1139fb);}});}module[a14_0xb114aa(0xbb)]={'createJobFileRollback':createJobFileRollback,'retrieveData':retrieveData,'prepareDataForDeploy':prepareDataForDeploy,'deployData':deployData,'handleNoComponents':handleNoComponents,'callContinuePipelineVlocityDeploy':callContinuePipelineVlocityDeploy};