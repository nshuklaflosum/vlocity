const a14_0x2cb8ad=a14_0x1130;function a14_0x2836(){const _0x5b6605=['keys','10045910EybWnu','\x20\x20-\x20VlocityDataPackType:\x20','readdirSync','988459tvkfQx','\x20where\x20Name\x20LIKE\x20\x27%','resolve','144475ugGTaA','stringify','forEach','\x0aqueries:\x0a','log','Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.\x0a','End\x20Prepare\x20Data\x20For\x20Deploy','addLocalFolder','2810492teKuZH','Start\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','11WZjlYP','%\x27\x0a','post','zipBuffer','name','Start\x20Create\x20Job\x20File','join','9kXPDhW','/services/apexrest/','Start\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','30420816KLxSOL','push','3kgtvnd','Error\x20Deploy\x20Data','Error\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','vlocity','-sf.accessToken','unlocked-packages','2iaKBWc','length','packExport','End\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','7137921wvvgsX','base64','End\x20Retrieve\x20Data','isDirectory','6444472riUovF','-job','toBuffer','catch','End\x20Deploy\x20Data','toString','138WLiEpk','SOURCE_FOLDER','METHOD_BACKUP_LOG','UNZIP_CATALOG_NAME','Start\x20Retrieve\x20Data','then','Start\x20Deploy\x20Data','replace','End\x20Create\x20Job\x20File','Error\x20Prepare\x20Data\x20For\x20Deploy','exports'];a14_0x2836=function(){return _0x5b6605;};return a14_0x2836();}(function(_0x2b58f9,_0x50c560){const _0x121a3e=a14_0x1130,_0x334ba8=_0x2b58f9();while(!![]){try{const _0x41718b=-parseInt(_0x121a3e(0x7a))/0x1*(-parseInt(_0x121a3e(0x99))/0x2)+parseInt(_0x121a3e(0x93))/0x3*(parseInt(_0x121a3e(0x85))/0x4)+-parseInt(_0x121a3e(0x7d))/0x5*(parseInt(_0x121a3e(0x6b))/0x6)+-parseInt(_0x121a3e(0x9d))/0x7+parseInt(_0x121a3e(0x65))/0x8*(-parseInt(_0x121a3e(0x8e))/0x9)+-parseInt(_0x121a3e(0x77))/0xa*(parseInt(_0x121a3e(0x87))/0xb)+parseInt(_0x121a3e(0x91))/0xc;if(_0x41718b===_0x50c560)break;else _0x334ba8['push'](_0x334ba8['shift']());}catch(_0x4c44be){_0x334ba8['push'](_0x334ba8['shift']());}}}(a14_0x2836,0xb2a40));const fs=require('fs'),AdmZip=require('adm-zip'),childProcess=require('../../../services/child-process'),constants=require('../../../constants'),http=require('../../../services/http');function createJobFileRollback(_0x4a87be,_0x1be716,_0x1b7b83,_0x23a2c6){return new Promise((_0x3f5546,_0x1bc691)=>{const _0x13727e=a14_0x1130;try{_0x23a2c6[_0x13727e(0x81)](_0x13727e(0x8c));let _0xa1164b='projectPath:\x20./'+constants[_0x13727e(0x6e)]+_0x13727e(0x80);Object[_0x13727e(0x76)](_0x1be716)['forEach'](_0x490cc5=>{const _0xc65c9a=_0x13727e;_0x1be716[_0x490cc5][_0xc65c9a(0x7f)](_0x1da97d=>{constants['DATA_PACK_TYPES_QUERIES_MAP'][_0x490cc5]['forEach'](_0x245278=>{const _0x4b351c=a14_0x1130;_0xa1164b+=_0x4b351c(0x78)+_0x490cc5+'\x0a',_0xa1164b+='\x20\x20\x20\x20query:\x20Select\x20Id\x20from\x20'+_0x245278+_0x4b351c(0x7b)+_0x1da97d+_0x4b351c(0x88);});});}),fs['appendFileSync'](_0x4a87be+'/'+constants['JOB_FILE_NAME'],_0xa1164b),_0x23a2c6[_0x13727e(0x81)](_0x13727e(0x73)),_0x3f5546();}catch(_0x5741c5){_0x23a2c6[_0x13727e(0x81)]('Error\x20Create\x20Job\x20File'),_0x1bc691(_0x5741c5);}});}function retrieveData(_0x54fbd0,_0x56b95e,_0x4cfa63,_0x266dad){return new Promise((_0x166303,_0x454c3b)=>{const _0x414009=a14_0x1130;try{_0x266dad[_0x414009(0x81)](_0x414009(0x6f));const _0x5bfe63=_0x414009(0x96),_0x48fda4=[_0x414009(0x97),''+_0x4cfa63,'-sf.instanceUrl',''+_0x56b95e,_0x414009(0x66),''+constants['JOB_FILE_NAME'],'-autoRetryErrors','-maxDepth','0',_0x414009(0x9b)];_0x266dad['log'](_0x48fda4['slice'](0x2)[_0x414009(0x8d)]('\x20'));const _0x240857={'cwd':''+_0x54fbd0,'maxBuffer':0x400*0x1f4,'shell':!![]};childProcess['callChildProcess'](_0x5bfe63,_0x48fda4,_0x266dad,_0x240857)['then'](_0x27020e=>{const _0x1d707d=_0x414009;_0x266dad[_0x1d707d(0x81)](_0x1d707d(0x9f)),_0x166303(_0x27020e);})[_0x414009(0x68)](_0x2028f7=>{_0x266dad['log']('Error\x20Retrieve\x20Data\x20'+_0x2028f7),_0x454c3b(_0x2028f7);});}catch(_0x5428fd){_0x454c3b(_0x5428fd);}});}function prepareDataForDeploy(_0x371634,_0x838286){return new Promise((_0x29e23e,_0x422d48)=>{const _0x161c01=a14_0x1130;try{_0x838286[_0x161c01(0x81)]('Start\x20Prepare\x20Data\x20For\x20Deploy');const _0x51361d=_0x371634+'/'+constants[_0x161c01(0x6c)];let _0x475ece=new AdmZip();const _0x822b00=fs[_0x161c01(0x79)](_0x51361d,{'withFileTypes':!![]}),_0x33b9ec=[];_0x822b00['forEach'](_0x1e5751=>{const _0x6c0887=_0x161c01;if(_0x1e5751[_0x6c0887(0xa0)]()){const _0x439c83=_0x475ece[_0x6c0887(0x67)]()[_0x6c0887(0x6a)](_0x6c0887(0x9e));_0x439c83['length']>0x1e8480&&(_0x33b9ec[_0x6c0887(0x92)](_0x439c83),_0x475ece=new AdmZip()),_0x475ece[_0x6c0887(0x84)](_0x51361d+'/'+_0x1e5751[_0x6c0887(0x8b)],_0x1e5751[_0x6c0887(0x8b)]);}}),_0x33b9ec['push'](_0x475ece[_0x161c01(0x67)]()[_0x161c01(0x6a)](_0x161c01(0x9e))),_0x838286[_0x161c01(0x81)](_0x161c01(0x83)),_0x29e23e(_0x33b9ec);}catch(_0x18246f){_0x838286[_0x161c01(0x81)](_0x161c01(0x74)),_0x422d48(_0x18246f);}});}function deployData(_0xb08273,_0x48be8f,_0x33f420,_0x11aa1a,_0x1c9204,_0x1e9657,_0x45970e,_0x373080){return new Promise((_0x3f90f2,_0x31ebda)=>{const _0xf0059b=a14_0x1130;try{_0x373080[_0xf0059b(0x81)](_0xf0059b(0x71));const _0x30793a={'zipBuffer':'','pipelineId':_0x1c9204,'logId':_0x33f420,'branchId':_0x45970e,'pipelineNumber':_0x1e9657};let _0x40d88b=Promise[_0xf0059b(0x7c)](),_0x5a7571=0x1;_0x11aa1a[_0xf0059b(0x7f)](_0x35eb9b=>{const _0xc8da0a=_0xf0059b;_0x30793a[_0xc8da0a(0x8a)]=_0x35eb9b,_0x30793a['isStartDeploy']=_0x5a7571===_0x11aa1a[_0xc8da0a(0x9a)];const _0x292a01={'methodType':constants[_0xc8da0a(0x6d)],'body':JSON[_0xc8da0a(0x7e)](_0x30793a)};_0x40d88b=_0x40d88b[_0xc8da0a(0x70)](()=>postDeploy(_0xb08273,_0x48be8f,_0x292a01)),_0x5a7571++;}),_0x40d88b[_0xf0059b(0x70)](()=>{const _0x5b90cf=_0xf0059b;_0x373080['log'](_0x5b90cf(0x69)),_0x3f90f2();})[_0xf0059b(0x68)](_0x10fb86=>{const _0x33e9ba=_0xf0059b;_0x373080['log'](_0x33e9ba(0x94)),_0x31ebda(_0x10fb86);});}catch(_0x2f6ad4){_0x373080[_0xf0059b(0x81)]('Error\x20Deploy\x20Data'),_0x31ebda(_0x2f6ad4);}});}function handleNoComponents(_0x4c31c1,_0x11699b,_0x1e886d,_0x88c547,_0x4d2a34,_0x4fe2ea,_0x255c1a,_0x2398db){return new Promise((_0x1b1163,_0xd530ca)=>{const _0x156e1c=a14_0x1130;try{_0x2398db[_0x156e1c(0x81)](_0x156e1c(0x90)),_0x1e886d=_0x1e886d&&_0x1e886d['length']?_0x1e886d[_0x156e1c(0x72)]('__','')+'/':'';const _0x12dc7c={'message':'Components\x20not\x20found!','pipelineId':_0x4d2a34,'logId':_0x88c547,'branchId':_0x255c1a,'pipelineNumber':_0x4fe2ea,'isStartDeploy':!![]},_0x511b26=_0x4c31c1+_0x156e1c(0x8f)+_0x1e886d+_0x156e1c(0x98),_0x5bbe6e={'methodType':constants['METHOD_BACKUP_LOG_ERROR'],'body':JSON[_0x156e1c(0x7e)](_0x12dc7c)};postDeploy(_0x511b26,_0x11699b,_0x1e886d,_0x5bbe6e)[_0x156e1c(0x70)](()=>{const _0x127fa9=_0x156e1c;_0x2398db[_0x127fa9(0x81)](_0x127fa9(0x9c)),_0x1b1163();})[_0x156e1c(0x68)](_0x1647b9=>{const _0x51c0c8=_0x156e1c;_0xd530ca(_0x1647b9),_0x2398db[_0x51c0c8(0x81)](_0x51c0c8(0x82));});}catch(_0x2a0e7b){_0x2398db[_0x156e1c(0x81)]('Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.'),_0xd530ca(_0x2a0e7b);}});}function postDeploy(_0x3dcb97,_0x28e1ea,_0x24d238){return new Promise((_0x596eba,_0x5d2a40)=>{const _0x268777=a14_0x1130;try{http[_0x268777(0x89)](_0x3dcb97,_0x28e1ea,_0x24d238)['then'](_0x31ba01=>{_0x596eba(_0x31ba01);})['catch'](_0x391216=>{const _0x387965=_0x268777;console[_0x387965(0x81)](_0x391216),_0x5d2a40(_0x391216);});}catch(_0x4ae327){_0x5d2a40(_0x4ae327);}});}function a14_0x1130(_0x4ec3b9,_0x94d352){const _0x28368c=a14_0x2836();return a14_0x1130=function(_0x1130f6,_0x3cc7d8){_0x1130f6=_0x1130f6-0x65;let _0x4a8dbe=_0x28368c[_0x1130f6];return _0x4a8dbe;},a14_0x1130(_0x4ec3b9,_0x94d352);}function callContinuePipelineVlocityDeploy(_0x463cf2,_0x364f52,_0x42e43c,_0x4405a8,_0x165300,_0x46d480,_0x1c9381,_0x699930){return new Promise((_0x29a289,_0x164c24)=>{const _0x3d5ecb=a14_0x1130;try{_0x364f52=_0x364f52&&_0x364f52[_0x3d5ecb(0x9a)]?_0x364f52[_0x3d5ecb(0x72)]('__','')+'/':'',_0x699930['log'](_0x3d5ecb(0x86));const _0x5369b1={'pipelineId':_0x42e43c,'pipelineNumber':_0x4405a8,'logId':_0x1c9381,'branchId':_0x46d480,'pipelineKey':_0x165300},_0x17772f={'methodType':constants['METHOD_NEXT_VLOCITY_CONTINUE_DEPLOY_STEP'],'body':JSON[_0x3d5ecb(0x7e)](_0x5369b1)};http['post'](_0x463cf2,_0x364f52,_0x17772f)[_0x3d5ecb(0x70)](_0x5a694e=>{_0x699930['log']('End\x20Continue\x20Vlocity\x20Pipeline\x20Deploy'),_0x29a289(_0x5a694e);})[_0x3d5ecb(0x68)](_0x4e9878=>{const _0x2e3764=_0x3d5ecb;_0x699930[_0x2e3764(0x81)](_0x2e3764(0x95)),_0x164c24(_0x4e9878);});}catch(_0x542c76){_0x164c24(_0x542c76);}});}module[a14_0x2cb8ad(0x75)]={'createJobFileRollback':createJobFileRollback,'retrieveData':retrieveData,'prepareDataForDeploy':prepareDataForDeploy,'deployData':deployData,'handleNoComponents':handleNoComponents,'callContinuePipelineVlocityDeploy':callContinuePipelineVlocityDeploy};