const a14_0x2bb997=a14_0x2f61;(function(_0x22a2fc,_0x2469fd){const _0x1202c2=a14_0x2f61,_0x1528b2=_0x22a2fc();while(!![]){try{const _0x277714=-parseInt(_0x1202c2(0xaf))/0x1+parseInt(_0x1202c2(0xcb))/0x2+-parseInt(_0x1202c2(0xe6))/0x3+-parseInt(_0x1202c2(0xd5))/0x4*(parseInt(_0x1202c2(0xc8))/0x5)+parseInt(_0x1202c2(0xdb))/0x6+parseInt(_0x1202c2(0xc9))/0x7*(parseInt(_0x1202c2(0xea))/0x8)+parseInt(_0x1202c2(0xe2))/0x9;if(_0x277714===_0x2469fd)break;else _0x1528b2['push'](_0x1528b2['shift']());}catch(_0x4674a8){_0x1528b2['push'](_0x1528b2['shift']());}}}(a14_0x4325,0x2edad));function a14_0x2f61(_0x14f06c,_0x239e7c){const _0x4325e4=a14_0x4325();return a14_0x2f61=function(_0x2f61b1,_0x44dc26){_0x2f61b1=_0x2f61b1-0xa8;let _0x1f3e34=_0x4325e4[_0x2f61b1];return _0x1f3e34;},a14_0x2f61(_0x14f06c,_0x239e7c);}const fs=require('fs'),AdmZip=require('adm-zip'),childProcess=require(a14_0x2bb997(0xe7)),constants=require('../../../constants'),http=require(a14_0x2bb997(0xb2));function createJobFileRollback(_0x5f4f4a,_0x744ef4,_0x431c0c,_0x474947){return new Promise((_0x414552,_0x17593e)=>{const _0x2e1e4f=a14_0x2f61;try{_0x474947[_0x2e1e4f(0xb9)]('Start\x20Create\x20Job\x20File');let _0x4db3ae=_0x2e1e4f(0xb4)+constants[_0x2e1e4f(0xbe)]+_0x2e1e4f(0xad);Object[_0x2e1e4f(0xce)](_0x744ef4)[_0x2e1e4f(0xc1)](_0x297dbc=>{const _0x505210=_0x2e1e4f;_0x744ef4[_0x297dbc][_0x505210(0xc1)](_0x2a19da=>{const _0x1d9174=_0x505210;constants[_0x1d9174(0xcd)][_0x297dbc][_0x1d9174(0xc1)](_0xab4c9c=>{const _0x265e9a=_0x1d9174;_0x4db3ae+=_0x265e9a(0xb6)+_0x297dbc+'\x0a',_0x4db3ae+=_0x265e9a(0xae)+_0xab4c9c+_0x265e9a(0xac)+_0x2a19da+'%\x27\x0a';});});}),fs[_0x2e1e4f(0xc5)](_0x5f4f4a+'/'+constants[_0x2e1e4f(0xba)],_0x4db3ae),_0x474947[_0x2e1e4f(0xb9)](_0x2e1e4f(0xab)),_0x414552();}catch(_0x5e6806){_0x474947[_0x2e1e4f(0xb9)](_0x2e1e4f(0xe8)),_0x17593e(_0x5e6806);}});}function retrieveData(_0x334250,_0x1a467d,_0x53d03b,_0x4f59d6){return new Promise((_0x3e6c55,_0x5d4eae)=>{const _0x420601=a14_0x2f61;try{_0x4f59d6['log']('Start\x20Retrieve\x20Data');const _0x51c34d=_0x420601(0xe1),_0x788a00=[_0x420601(0xd6),''+_0x53d03b,'-sf.instanceUrl',''+_0x1a467d,_0x420601(0xc2),''+constants['JOB_FILE_NAME'],_0x420601(0xc4),_0x420601(0xa8),'0',_0x420601(0xb7)];_0x4f59d6[_0x420601(0xb9)](_0x788a00[_0x420601(0xe0)](0x2)['join']('\x20'));const _0x13beb7={'cwd':''+_0x334250,'maxBuffer':0x400*0x1f4,'shell':!![]};childProcess[_0x420601(0xcc)](_0x51c34d,_0x788a00,_0x4f59d6,_0x13beb7)[_0x420601(0xa9)](_0x26022a=>{const _0x53f919=_0x420601;_0x4f59d6[_0x53f919(0xb9)](_0x53f919(0xd4)),_0x3e6c55(_0x26022a);})[_0x420601(0xb5)](_0x32a53e=>{const _0x172d3c=_0x420601;_0x4f59d6[_0x172d3c(0xb9)](_0x172d3c(0xd2)+_0x32a53e),_0x5d4eae(_0x32a53e);});}catch(_0x2264c7){_0x5d4eae(_0x2264c7);}});}function a14_0x4325(){const _0x6a3276=['zipBuffer','forEach','-job','name','-autoRetryErrors','appendFileSync','Error\x20Prepare\x20Data\x20For\x20Deploy','Error\x20Deploy\x20Data','271195gLZQwj','21qtjxQH','METHOD_NEXT_VLOCITY_CONTINUE_DEPLOY_STEP','722896iaLbgj','callChildProcess','DATA_PACK_TYPES_QUERIES_MAP','keys','End\x20Prepare\x20Data\x20For\x20Deploy','Start\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','base64','Error\x20Retrieve\x20Data\x20','addLocalFolder','End\x20Retrieve\x20Data','12ZlSRnc','-sf.accessToken','Start\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','exports','METHOD_BACKUP_LOG','stringify','902796mvUrHY','isStartDeploy','toString','push','length','slice','vlocity','3265191ovVfBE','Start\x20Prepare\x20Data\x20For\x20Deploy','toBuffer','replace','1126161eydZAB','../../../services/child-process','Error\x20Create\x20Job\x20File','post','214768PISlsy','Start\x20Deploy\x20Data','-maxDepth','then','Error\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','End\x20Create\x20Job\x20File','\x20where\x20Name\x20LIKE\x20\x27%','\x0aqueries:\x0a','\x20\x20\x20\x20query:\x20Select\x20Id\x20from\x20','225230AhwWoo','End\x20Continue\x20Vlocity\x20Pipeline\x20Deploy','/services/apexrest/','../../../services/http','Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.','projectPath:\x20./','catch','\x20\x20-\x20VlocityDataPackType:\x20','packExport','Error\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.\x0a','log','JOB_FILE_NAME','Components\x20not\x20found!','End\x20Deploy\x20Data','unlocked-packages','UNZIP_CATALOG_NAME','End\x20Update\x20Log.\x20No\x20Components\x20to\x20Backup.'];a14_0x4325=function(){return _0x6a3276;};return a14_0x4325();}function prepareDataForDeploy(_0xdf2ecf,_0x3e9aa5){return new Promise((_0x27963e,_0x46d48e)=>{const _0x5ccb8e=a14_0x2f61;try{_0x3e9aa5['log'](_0x5ccb8e(0xe3));const _0x216279=_0xdf2ecf+'/'+constants['SOURCE_FOLDER'];let _0x177d88=new AdmZip();const _0x29f6b5=fs['readdirSync'](_0x216279,{'withFileTypes':!![]}),_0x92f670=[];_0x29f6b5[_0x5ccb8e(0xc1)](_0x23313c=>{const _0x5bfc66=_0x5ccb8e;if(_0x23313c['isDirectory']()){const _0x5597ba=_0x177d88[_0x5bfc66(0xe4)]()[_0x5bfc66(0xdd)](_0x5bfc66(0xd1));_0x5597ba[_0x5bfc66(0xdf)]>0x1e8480&&(_0x92f670[_0x5bfc66(0xde)](_0x5597ba),_0x177d88=new AdmZip()),_0x177d88[_0x5bfc66(0xd3)](_0x216279+'/'+_0x23313c[_0x5bfc66(0xc3)],_0x23313c[_0x5bfc66(0xc3)]);}}),_0x92f670[_0x5ccb8e(0xde)](_0x177d88[_0x5ccb8e(0xe4)]()[_0x5ccb8e(0xdd)](_0x5ccb8e(0xd1))),_0x3e9aa5[_0x5ccb8e(0xb9)](_0x5ccb8e(0xcf)),_0x27963e(_0x92f670);}catch(_0x14a0a6){_0x3e9aa5[_0x5ccb8e(0xb9)](_0x5ccb8e(0xc6)),_0x46d48e(_0x14a0a6);}});}function deployData(_0x144559,_0x2e87cb,_0x48c589,_0x4ea455,_0x199785,_0x52f5a4,_0xbb1080,_0x49bcf4){return new Promise((_0x51a075,_0xb6f24b)=>{const _0x1e382a=a14_0x2f61;try{_0x49bcf4[_0x1e382a(0xb9)](_0x1e382a(0xeb));const _0x443965={'zipBuffer':'','pipelineId':_0x199785,'logId':_0x48c589,'branchId':_0xbb1080,'pipelineNumber':_0x52f5a4};let _0x5e9d5c=Promise['resolve'](),_0xc42b82=0x1;_0x4ea455[_0x1e382a(0xc1)](_0x4c9df5=>{const _0xa96983=_0x1e382a;_0x443965[_0xa96983(0xc0)]=_0x4c9df5,_0x443965[_0xa96983(0xdc)]=_0xc42b82===_0x4ea455[_0xa96983(0xdf)];const _0x249ba1={'methodType':constants[_0xa96983(0xd9)],'body':JSON[_0xa96983(0xda)](_0x443965)};_0x5e9d5c=_0x5e9d5c['then'](()=>postDeploy(_0x144559,_0x2e87cb,_0x249ba1)),_0xc42b82++;}),_0x5e9d5c[_0x1e382a(0xa9)](()=>{const _0x490b23=_0x1e382a;_0x49bcf4['log'](_0x490b23(0xbc)),_0x51a075();})[_0x1e382a(0xb5)](_0x4b0acf=>{const _0x38f0a5=_0x1e382a;_0x49bcf4['log'](_0x38f0a5(0xc7)),_0xb6f24b(_0x4b0acf);});}catch(_0x504686){_0x49bcf4[_0x1e382a(0xb9)](_0x1e382a(0xc7)),_0xb6f24b(_0x504686);}});}function handleNoComponents(_0x351f1c,_0x413610,_0x806079,_0x385030,_0x587383,_0x33f9da,_0x35fb25,_0x435ace){return new Promise((_0x3f2f34,_0x53b566)=>{const _0x47c56d=a14_0x2f61;try{_0x435ace[_0x47c56d(0xb9)](_0x47c56d(0xd7)),_0x806079=_0x806079&&_0x806079[_0x47c56d(0xdf)]?_0x806079[_0x47c56d(0xe5)]('__','')+'/':'';const _0x4def94={'message':_0x47c56d(0xbb),'pipelineId':_0x587383,'logId':_0x385030,'branchId':_0x35fb25,'pipelineNumber':_0x33f9da,'isStartDeploy':!![]},_0x34aa21=_0x351f1c+_0x47c56d(0xb1)+_0x806079+_0x47c56d(0xbd),_0x2386d9={'methodType':constants['METHOD_BACKUP_LOG_ERROR'],'body':JSON[_0x47c56d(0xda)](_0x4def94)};postDeploy(_0x34aa21,_0x413610,_0x806079,_0x2386d9)['then'](()=>{const _0x35c88e=_0x47c56d;_0x435ace['log'](_0x35c88e(0xbf)),_0x3f2f34();})[_0x47c56d(0xb5)](_0x51a3fe=>{const _0x9e53ac=_0x47c56d;_0x53b566(_0x51a3fe),_0x435ace['log'](_0x9e53ac(0xb8));});}catch(_0x3e8bea){_0x435ace['log'](_0x47c56d(0xb3)),_0x53b566(_0x3e8bea);}});}function postDeploy(_0xd8b90e,_0x3182b8,_0x503825){return new Promise((_0x292f9a,_0x5e44ce)=>{const _0x4ff561=a14_0x2f61;try{http[_0x4ff561(0xe9)](_0xd8b90e,_0x3182b8,_0x503825)['then'](_0x421702=>{_0x292f9a(_0x421702);})[_0x4ff561(0xb5)](_0x48a3e7=>{const _0x193b4a=_0x4ff561;console[_0x193b4a(0xb9)](_0x48a3e7),_0x5e44ce(_0x48a3e7);});}catch(_0x4de395){_0x5e44ce(_0x4de395);}});}function callContinuePipelineVlocityDeploy(_0x333c62,_0x16c975,_0x23620f,_0x4459a7,_0x279c65,_0x34a317,_0x1471a2,_0x400ac4){return new Promise((_0xa1b9d7,_0x527f1a)=>{const _0x2046a9=a14_0x2f61;try{_0x16c975=_0x16c975&&_0x16c975[_0x2046a9(0xdf)]?_0x16c975[_0x2046a9(0xe5)]('__','')+'/':'',_0x400ac4[_0x2046a9(0xb9)](_0x2046a9(0xd0));const _0x527db9={'pipelineId':_0x23620f,'pipelineNumber':_0x4459a7,'logId':_0x1471a2,'branchId':_0x34a317,'pipelineKey':_0x279c65},_0x2212df={'methodType':constants[_0x2046a9(0xca)],'body':JSON['stringify'](_0x527db9)};http['post'](_0x333c62,_0x16c975,_0x2212df)['then'](_0x11783e=>{const _0xad7c92=_0x2046a9;_0x400ac4[_0xad7c92(0xb9)](_0xad7c92(0xb0)),_0xa1b9d7(_0x11783e);})[_0x2046a9(0xb5)](_0x40c5a9=>{const _0x587d3c=_0x2046a9;_0x400ac4[_0x587d3c(0xb9)](_0x587d3c(0xaa)),_0x527f1a(_0x40c5a9);});}catch(_0x13d102){_0x527f1a(_0x13d102);}});}module[a14_0x2bb997(0xd8)]={'createJobFileRollback':createJobFileRollback,'retrieveData':retrieveData,'prepareDataForDeploy':prepareDataForDeploy,'deployData':deployData,'handleNoComponents':handleNoComponents,'callContinuePipelineVlocityDeploy':callContinuePipelineVlocityDeploy};