const a53_0x2fbf51=a53_0x2bd2;(function(_0x5ee71f,_0x19310d){const _0x2bda64=a53_0x2bd2,_0x5eff94=_0x5ee71f();while(!![]){try{const _0x33a0aa=parseInt(_0x2bda64(0x1ba))/0x1*(-parseInt(_0x2bda64(0x1ef))/0x2)+-parseInt(_0x2bda64(0x1dc))/0x3+parseInt(_0x2bda64(0x1bd))/0x4+-parseInt(_0x2bda64(0x1e1))/0x5*(parseInt(_0x2bda64(0x1de))/0x6)+parseInt(_0x2bda64(0x1f2))/0x7+-parseInt(_0x2bda64(0x1d9))/0x8+parseInt(_0x2bda64(0x1cf))/0x9;if(_0x33a0aa===_0x19310d)break;else _0x5eff94['push'](_0x5eff94['shift']());}catch(_0x2087b2){_0x5eff94['push'](_0x5eff94['shift']());}}}(a53_0x1a79,0xbc3fe));function a53_0x1a79(){const _0x3a5a03=['Job_Completed__c','catch','push','recordList','error','Error\x20Get\x20Attachment\x20Body\x20','Errors','stringify','Status__c','js-yaml','32CCIQoV','parseFloat','message','8104306GXMNMh','idList','toString','Start\x20Next\x20Vlocity\x20Step','../../constants','accessToken','Succeed__c','length','getDate','resolve','Error\x20Update\x20Metadata\x20Log\x20','Unknown\x20error:\x20','application/json','string','base64','response','65891KHbghD','Error\x20Call\x20Component\x20List','then','2335256aLionA','Start\x20Call\x20Component\x20List','join','Partial\x20Completed','logs','log','Is_Error__c','METHOD_UPDATE_LOG','toFixed','instanceUrl','replace','Start\x20Update\x20Metadata\x20Log\x20isError\x20','End\x20Update\x20Metadata\x20Log','updateAttachment','....','../storage','post','Start\x20Update\x20Log\x20is\x20Success\x20=\x20','9835911jbFFCX','Error\x20Update\x20Attachment\x20Log\x20','End\x20Call\x20Component\x20List','load','End\x20Next\x20Vlocity\x20Step','exports','Retrieved:\x20','unlocked-packages','from','text/plain','2215424naYWxi','\x20isSuccess\x20','getSeconds','197961BJHDTF','status','666210OrHYcY','data','getAttachmentBodyStream','30jvhWvH','End\x20Update\x20Log\x20is\x20Success\x20=\x20','end','Exception'];a53_0x1a79=function(){return _0x3a5a03;};return a53_0x1a79();}const axios=require('axios'),yaml=require(a53_0x2fbf51(0x1ee)),constants=require(a53_0x2fbf51(0x1f6)),storage=require(a53_0x2fbf51(0x1cc)),CLIENT_CREDENTIALS_TYPE='client_credentials';async function post(_0xd7ae97,_0x5d4d70,_0x2c2340,_0x3ca98e=a53_0x2fbf51(0x1d6),_0x24c684=![]){const _0x487324=a53_0x2fbf51,_0x32cd03={'Authorization':'OAuth\x20'+_0xd7ae97[_0x487324(0x1f7)],'Content-Type':_0x487324(0x1b6)};_0x5d4d70=_0x5d4d70&&_0x5d4d70[_0x487324(0x1b1)]?_0x5d4d70[_0x487324(0x1c7)]('__','')+'/':'';const _0x1f723d=_0xd7ae97[_0x487324(0x1c6)]+'/services/apexrest/'+_0x5d4d70+_0x3ca98e;try{return await axios[_0x487324(0x1cd)](_0x1f723d,_0x2c2340,{'headers':_0x32cd03});}catch(_0x508d33){if(_0x508d33?.[_0x487324(0x1b9)]?.[_0x487324(0x1dd)]===0x191&&!_0x24c684&&_0xd7ae97['clientId']&&_0xd7ae97['clientSecret'])return _0xd7ae97['accessToken']=await refreshToken(_0xd7ae97),await post(_0xd7ae97,_0x5d4d70,_0x2c2340,_0x3ca98e,!![]);throw getErrorMessage(_0x508d33);}}function getErrorMessage(_0x9db55c){const _0x5f4969=a53_0x2fbf51,_0x37d4ed=_0x9db55c?.[_0x5f4969(0x1b9)]?.['data'];if(_0x37d4ed){if(typeof _0x37d4ed===_0x5f4969(0x1b7))return _0x37d4ed;if(_0x37d4ed[_0x5f4969(0x1f1)])return _0x37d4ed['message'];}if(_0x9db55c?.[_0x5f4969(0x1f1)])return _0x9db55c[_0x5f4969(0x1f1)];return _0x5f4969(0x1b5)+_0x9db55c;}async function refreshToken({instanceUrl:_0x54d56e,clientId:_0x42457e,clientSecret:_0x5f30c9}){const _0xcf5d4f=a53_0x2fbf51,{data:_0x5007e2}=await axios[_0xcf5d4f(0x1cd)](_0x54d56e+'/services/oauth2/token',null,{'params':{'grant_type':CLIENT_CREDENTIALS_TYPE,'client_id':_0x42457e,'client_secret':_0x5f30c9}});return _0x5007e2['access_token'];}function callUpdateInfo(_0x1e3998,_0x51caca,_0x787fe0,_0x1d818a,_0x435dbb,_0x92570a,_0x5344c1,_0x379982=![]){return new Promise((_0x27705e,_0x47f8bd)=>{const _0x4d8e62=a53_0x2bd2;try{try{const _0x43418e=yaml['load'](_0x435dbb);_0x43418e[_0x4d8e62(0x1eb)]&&(_0x379982=_0x43418e[_0x4d8e62(0x1eb)][_0x4d8e62(0x1b1)]>0x0);}catch(_0x497087){}_0x5344c1[_0x4d8e62(0x1c2)](_0x4d8e62(0x1ce)+_0x92570a);const _0x92ad1e={'logId':_0x51caca,'attachmentLogId':_0x1d818a,'isJobCompleted':!![],'status':'Completed','isSuccess':_0x92570a,'isError':_0x379982,'attachmentBody':_0x435dbb+'Full\x20Process:\x0a\x0a'+_0x5344c1[_0x4d8e62(0x1c1)]['join']('\x0a')},_0x58f73e={'methodType':constants[_0x4d8e62(0x1c4)],'body':JSON['stringify'](_0x92ad1e)};post(_0x1e3998,_0x787fe0,_0x58f73e)[_0x4d8e62(0x1bc)](_0x2da431=>{const _0x4eb960=_0x4d8e62;_0x5344c1[_0x4eb960(0x1c2)](_0x4eb960(0x1e2)+_0x92570a),_0x27705e(_0x2da431);})[_0x4d8e62(0x1e6)](_0x1dc8a9=>{const _0x2af918=_0x4d8e62;_0x5344c1[_0x2af918(0x1c2)]('Error\x20Update\x20Log\x20is\x20Success\x20=\x20'+_0x92570a),_0x47f8bd(_0x1dc8a9);});}catch(_0x395b11){_0x47f8bd(_0x395b11);}});}function a53_0x2bd2(_0x4e2515,_0x4aa595){const _0x1a7937=a53_0x1a79();return a53_0x2bd2=function(_0x2bd2ef,_0x248c7d){_0x2bd2ef=_0x2bd2ef-0x1b0;let _0x261f32=_0x1a7937[_0x2bd2ef];return _0x261f32;},a53_0x2bd2(_0x4e2515,_0x4aa595);}function callNextVlocityStep(_0x3dbd2d,_0x29ab90,_0x46f302,_0x5a261d,_0x11394e,_0x528452,_0x3be937,_0x1f770b){return new Promise((_0x29a970,_0x14d4bf)=>{const _0x143197=a53_0x2bd2;try{_0x1f770b[_0x143197(0x1c2)](_0x143197(0x1f5));const _0x10a065={'pipelineId':_0x46f302,'pipelineNumber':_0x5a261d,'isPass':_0x528452,'branchId':_0x3be937,'pipelineKey':_0x11394e},_0x20f63f={'methodType':constants['METHOD_NEXT_VLOCITY_STEP'],'body':JSON[_0x143197(0x1ec)](_0x10a065)};post(_0x3dbd2d,_0x29ab90,_0x20f63f)[_0x143197(0x1bc)](_0x5c5095=>{const _0x390325=_0x143197;_0x1f770b[_0x390325(0x1c2)](_0x390325(0x1d3)),_0x29a970(_0x5c5095);})[_0x143197(0x1e6)](_0x1078e5=>{const _0x5c4398=_0x143197;_0x1f770b[_0x5c4398(0x1c2)]('Error\x20Next\x20Vlocity\x20Step'),_0x14d4bf(_0x1078e5);});}catch(_0x5701da){_0x14d4bf(_0x5701da);}});}function callComponentList(_0x23f12d,_0x180d9f,_0x201bdc,_0x3a0d5a,_0x1c0155,_0x14f8ab=[]){return new Promise((_0x42bafc,_0x474f61)=>{const _0x6bff94=a53_0x2bd2;try{_0x1c0155[_0x6bff94(0x1c2)](_0x6bff94(0x1be));const _0x40b6e5={'methodType':constants['METHOD_TYPE_GET_ATTACHMENTS'],'body':JSON[_0x6bff94(0x1ec)](_0x180d9f)};post(_0x23f12d,_0x201bdc,_0x40b6e5)[_0x6bff94(0x1bc)](_0x192170=>{const _0x4c9526=_0x6bff94;let {data:_0x13eb18}=_0x192170;_0x13eb18=JSON['parse'](_0x13eb18),_0x1c0155['log'](_0x4c9526(0x1d5)+Number[_0x4c9526(0x1f0)](_0x14f8ab[_0x4c9526(0x1b1)]/_0x3a0d5a*0x64)[_0x4c9526(0x1c5)](0x2)+'%'),_0x14f8ab['push'](..._0x13eb18[_0x4c9526(0x1e8)]),_0x13eb18[_0x4c9526(0x1f3)]&&_0x13eb18[_0x4c9526(0x1f3)][_0x4c9526(0x1b1)]?callComponentList(_0x23f12d,_0x13eb18[_0x4c9526(0x1f3)],_0x201bdc,_0x3a0d5a,_0x1c0155,_0x14f8ab)['then'](_0x48d02a=>_0x42bafc(_0x48d02a))['catch'](_0x252ec3=>{const _0x34c59=_0x4c9526;_0x1c0155[_0x34c59(0x1c2)](_0x34c59(0x1bb)),_0x474f61(_0x252ec3);}):(_0x1c0155[_0x4c9526(0x1c2)](_0x4c9526(0x1d1)),_0x42bafc(_0x14f8ab));})[_0x6bff94(0x1e6)](_0x4ca5a0=>{const _0x3008da=_0x6bff94;_0x1c0155[_0x3008da(0x1c2)]('Error\x20Call\x20Component\x20List'),_0x474f61(_0x4ca5a0);});}catch(_0x380262){_0x1c0155['log'](_0x6bff94(0x1bb)),_0x474f61(_0x380262);}});}async function getBodyFromStream(_0x38a36f,_0x151006,_0x12be00){return new Promise(_0x768b61=>{const _0xff8eaa=a53_0x2bd2;try{const _0xf9f335=[];_0x38a36f['on'](_0xff8eaa(0x1df),(_0x2d8572,_0xa5b2bf)=>{const _0x2abab4=_0xff8eaa;_0xf9f335[_0x2abab4(0x1e7)](_0x2d8572);}),_0x38a36f['on'](_0xff8eaa(0x1e3),()=>{_0x151006?_0x768b61(_0xf9f335['join']('')):_0x768b61(Buffer['concat'](_0xf9f335));}),_0x38a36f['on'](_0xff8eaa(0x1e9),_0x5e0099=>{const _0x4bca99=_0xff8eaa;_0x12be00[_0x4bca99(0x1c2)]('Error\x20Get\x20Attachment\x20Body\x20'+_0x5e0099),_0x768b61('');});}catch(_0x3973d3){_0x12be00[_0xff8eaa(0x1c2)](_0xff8eaa(0x1ea)+_0x3973d3),_0x768b61('');}});}async function getAttachmentBody(_0x10c33a,_0x21d670,_0x19764d,_0x5c4f81=!![]){const _0x4e1d43=a53_0x2fbf51,_0x19ba6d=await _0x10c33a[_0x4e1d43(0x1e0)](_0x21d670);return await getBodyFromStream(_0x19ba6d,_0x5c4f81,_0x19764d);}function getTime(){const _0x3ad0f5=a53_0x2fbf51,_0x4fe81b=new Date(),_0x586bcd=[_0x4fe81b[_0x3ad0f5(0x1b2)](),_0x4fe81b['getMonth']()+0x1,_0x4fe81b['getFullYear'](),_0x4fe81b['getHours'](),_0x4fe81b['getMinutes'](),_0x4fe81b[_0x3ad0f5(0x1db)]()];return _0x586bcd['forEach'](_0x521d15=>_0x521d15=_0x521d15[_0x3ad0f5(0x1f4)]()['replace'](/^([0-9])$/,'0$1')),_0x586bcd[0x2]+'-'+_0x586bcd[0x1]+'-'+_0x586bcd[0x0]+'\x20'+_0x586bcd[0x3]+':'+_0x586bcd[0x4]+':'+_0x586bcd[0x5];}function callUpdateAttachmentLog(_0x398af4,_0x1a1747,_0x9ada02,_0x104446,_0x5efba7){return new Promise(_0x845c99=>{const _0x264ba6=a53_0x2bd2;try{const _0x337d64=_0x9ada02+'\x0a'+_0x104446['logs'][_0x264ba6(0x1bf)]('\x0a');_0x104446[_0x264ba6(0x1c1)]=[];const _0x574b6e={'Id':_0x1a1747,'Body':Buffer[_0x264ba6(0x1d7)](_0x337d64)[_0x264ba6(0x1f4)](_0x264ba6(0x1b8)),'ContentType':_0x264ba6(0x1d8)};_0x398af4[_0x264ba6(0x1ca)](_0x574b6e)[_0x264ba6(0x1bc)](()=>{_0x845c99(_0x5efba7);})['catch'](_0x4ca8c5=>{const _0x1f700a=_0x264ba6;_0x104446[_0x1f700a(0x1c2)](_0x1f700a(0x1d0)+_0x4ca8c5),_0x845c99(_0x5efba7);});}catch(_0xabe2cb){_0x104446[_0x264ba6(0x1c2)]('Error\x20Update\x20Attachment\x20Log\x20'+_0xabe2cb),_0x845c99(_0x5efba7);}});}function updateAttachmentLog(_0x52ff3a,_0x3c302c,_0x91dc2a,_0x47389f,_0x3210ae,_0x6c6cf=![]){return new Promise(_0x39edd9=>{const _0x57cbc5=a53_0x2bd2;try{_0x47389f[_0x57cbc5(0x1c2)](_0x57cbc5(0x1cb)),Promise[_0x57cbc5(0x1b3)]()[_0x57cbc5(0x1bc)](()=>getAttachmentBody(_0x3c302c,_0x91dc2a,_0x47389f))['then'](_0x56a5e4=>{const _0xf117b8=_0x57cbc5;if(_0x6c6cf)return storage['readLogFile'](_0x52ff3a,getTime(),_0x47389f)[_0xf117b8(0x1bc)](_0x26cc3d=>{const _0x5a7b57=_0xf117b8;try{const _0x5adc62=yaml[_0x5a7b57(0x1d2)](_0x26cc3d);_0x5adc62[_0x5a7b57(0x1eb)][_0x5a7b57(0x1b1)]&&(_0x3210ae=!![]);}catch(_0x4542df){_0x26cc3d='',_0x3210ae=!![];}const _0xe66bf8=_0x26cc3d+'\x0a'+_0x56a5e4;return callUpdateAttachmentLog(_0x3c302c,_0x91dc2a,_0xe66bf8,_0x47389f,_0x3210ae);});return callUpdateAttachmentLog(_0x3c302c,_0x91dc2a,_0x56a5e4,_0x47389f,_0x3210ae);})[_0x57cbc5(0x1bc)](()=>_0x39edd9(_0x3210ae))[_0x57cbc5(0x1e6)](()=>_0x39edd9(_0x3210ae));}catch(_0x14c48a){_0x47389f[_0x57cbc5(0x1c2)]('Error\x20Update\x20Attachment\x20Log\x20'+_0x14c48a),_0x39edd9(_0x3210ae);}});}function callUpdateLog(_0x58212a,_0x3e4dde,_0x303a10,_0x392618,_0x873633,_0x632d94=![]){return new Promise((_0x5db199,_0x5e4526)=>{const _0x203668=a53_0x2bd2;try{_0x873633['log'](_0x203668(0x1c8)+_0x632d94+_0x203668(0x1da)+_0x392618);const _0x4393ab=_0x392618&&!_0x632d94?'Completed':_0x392618&&_0x632d94?_0x203668(0x1c0):_0x203668(0x1e4),_0x4633fa={'Id':_0x3e4dde,[_0x303a10+_0x203668(0x1ed)]:_0x4393ab,[_0x303a10+_0x203668(0x1c3)]:_0x632d94,[_0x303a10+_0x203668(0x1b0)]:_0x392618,[_0x303a10+_0x203668(0x1e5)]:!![]};_0x58212a['updateMetadataLog'](_0x303a10,_0x4633fa)[_0x203668(0x1bc)](()=>{const _0x2e01a9=_0x203668;_0x873633['log'](_0x2e01a9(0x1c9)),_0x5db199(_0x4633fa[_0x303a10+_0x2e01a9(0x1c3)]);})[_0x203668(0x1e6)](_0x396c8a=>{const _0x3751c8=_0x203668;_0x873633[_0x3751c8(0x1c2)](_0x3751c8(0x1b4)+_0x396c8a),_0x5e4526(_0x396c8a);});}catch(_0x482c77){_0x873633['log'](_0x203668(0x1b4)+_0x482c77),_0x5e4526(_0x482c77);}});}module[a53_0x2fbf51(0x1d4)]={'getTime':getTime,'refreshToken':refreshToken,'post':post,'callUpdateInfo':callUpdateInfo,'callNextVlocityStep':callNextVlocityStep,'callComponentList':callComponentList,'updateAttachmentLog':updateAttachmentLog,'getAttachmentBody':getAttachmentBody,'callUpdateAttachmentLog':callUpdateAttachmentLog,'callUpdateLog':callUpdateLog};